<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FleetFlag - Physical Deployment Viewer</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.160.0/examples/js/controls/OrbitControls.js"></script>
    <style>
        :root {
            --primary: #002c5f;
            --secondary: #00aad2;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%);
            color: #e2e8f0;
        }

        .glass-panel {
            background: rgba(30, 41, 59, 0.7);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(148, 163, 184, 0.1);
            border-radius: 12px;
        }

        .hardware-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 6px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
        }

        .badge-cpu { background: #3b82f6; color: white; }
        .badge-ram { background: #8b5cf6; color: white; }
        .badge-storage { background: #ec4899; color: white; }
        .badge-network { background: #10b981; color: white; }

        .health-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            display: inline-block;
            animation: pulse 2s infinite;
        }

        .health-good { background: #10b981; box-shadow: 0 0 10px #10b981; }
        .health-warning { background: #f59e0b; box-shadow: 0 0 10px #f59e0b; }
        .health-critical { background: #ef4444; box-shadow: 0 0 10px #ef4444; }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .topology-node {
            position: absolute;
            width: 80px;
            height: 80px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.75rem;
            font-weight: 600;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid;
        }

        .topology-node:hover {
            transform: scale(1.1);
            box-shadow: 0 10px 30px rgba(0, 170, 210, 0.4);
        }

        .node-idc {
            background: rgba(59, 130, 246, 0.2);
            border-color: #3b82f6;
            color: #3b82f6;
        }

        .node-vehicle {
            background: rgba(16, 185, 129, 0.2);
            border-color: #10b981;
            color: #10b981;
        }

        .node-ecu {
            background: rgba(139, 92, 246, 0.2);
            border-color: #8b5cf6;
            color: #8b5cf6;
        }

        .topology-connection {
            position: absolute;
            height: 2px;
            background: linear-gradient(90deg, #00aad2 0%, transparent 100%);
            transform-origin: left center;
            animation: flow 2s linear infinite;
        }

        @keyframes flow {
            0% { background-position: 0 0; }
            100% { background-position: 50px 0; }
        }

        .spec-row {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid rgba(148, 163, 184, 0.1);
        }

        .spec-label {
            color: #94a3b8;
            font-size: 0.875rem;
        }

        .spec-value {
            color: #e2e8f0;
            font-weight: 600;
            font-size: 0.875rem;
        }

        #canvas3d {
            width: 100%;
            height: 500px;
            border-radius: 12px;
            background: rgba(15, 23, 42, 0.5);
        }

        .tab-button {
            padding: 12px 24px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            background: rgba(30, 41, 59, 0.5);
            border: 1px solid rgba(148, 163, 184, 0.2);
        }

        .tab-button.active {
            background: var(--secondary);
            color: white;
            border-color: var(--secondary);
        }

        .tab-button:hover:not(.active) {
            background: rgba(0, 170, 210, 0.1);
            border-color: var(--secondary);
        }

        .rack-server {
            background: rgba(30, 41, 59, 0.8);
            border: 2px solid #475569;
            border-radius: 6px;
            padding: 12px;
            margin: 8px 0;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .rack-server:hover {
            border-color: var(--secondary);
            transform: translateX(5px);
            box-shadow: 0 4px 20px rgba(0, 170, 210, 0.3);
        }

        .rack-server.active {
            border-color: var(--secondary);
            background: rgba(0, 170, 210, 0.1);
        }

        .power-meter {
            width: 100%;
            height: 8px;
            background: rgba(51, 65, 85, 0.5);
            border-radius: 4px;
            overflow: hidden;
            margin-top: 8px;
        }

        .power-bar {
            height: 100%;
            background: linear-gradient(90deg, #10b981 0%, #f59e0b 50%, #ef4444 100%);
            transition: width 0.5s ease;
        }

        .vehicle-diagram {
            position: relative;
            width: 100%;
            height: 400px;
            background: rgba(15, 23, 42, 0.5);
            border-radius: 12px;
            padding: 20px;
        }

        .vehicle-component {
            position: absolute;
            background: rgba(30, 41, 59, 0.8);
            border: 2px solid;
            border-radius: 8px;
            padding: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 100px;
            text-align: center;
        }

        .vehicle-component:hover {
            transform: scale(1.05);
            box-shadow: 0 8px 25px rgba(0, 170, 210, 0.4);
        }

        .component-hpc {
            border-color: #3b82f6;
            color: #3b82f6;
            top: 50px;
            left: 50%;
            transform: translateX(-50%);
        }

        .component-ccu {
            border-color: #8b5cf6;
            color: #8b5cf6;
            top: 180px;
            left: 50%;
            transform: translateX(-50%);
        }

        .component-ecu {
            border-color: #10b981;
            color: #10b981;
            top: 310px;
        }

        .ecu-adas { left: 15%; }
        .ecu-cluster { left: 45%; transform: translateX(-50%); }
        .ecu-tcu { right: 15%; }

        .connection-line {
            position: absolute;
            background: linear-gradient(180deg, #00aad2 0%, transparent 100%);
            width: 2px;
            left: 50%;
            transform: translateX(-50%);
        }

        .line-hpc-ccu {
            top: 110px;
            height: 70px;
        }

        .line-ccu-ecu {
            top: 240px;
            height: 70px;
        }
    </style>
</head>
<body class="p-6">
    <!-- Header -->
    <div class="glass-panel p-6 mb-6">
        <div class="flex items-center justify-between">
            <div class="flex items-center space-x-4">
                <div class="w-12 h-12 bg-gradient-to-br from-blue-500 to-cyan-400 rounded-lg flex items-center justify-center">
                    <i class="fas fa-server text-white text-xl"></i>
                </div>
                <div>
                    <h1 class="text-2xl font-bold text-white">Physical Deployment Viewer</h1>
                    <p class="text-sm text-gray-400">현대자동차 SDV Feature Flag 시스템 물리적 배포 구성도</p>
                </div>
            </div>
            <div class="flex items-center space-x-4">
                <div class="text-right">
                    <div class="text-sm text-gray-400">Total Infrastructure</div>
                    <div class="text-xl font-bold text-white">3 Racks · 12 Servers · 125k Vehicles</div>
                </div>
                <div class="w-12 h-12 bg-green-500/20 rounded-lg flex items-center justify-center">
                    <span class="health-indicator health-good"></span>
                </div>
            </div>
        </div>
    </div>

    <!-- Tab Navigation -->
    <div class="glass-panel p-4 mb-6">
        <div class="flex space-x-4">
            <button class="tab-button active" onclick="switchTab('datacenter')">
                <i class="fas fa-building mr-2"></i>Data Center (IDC)
            </button>
            <button class="tab-button" onclick="switchTab('vehicle')">
                <i class="fas fa-car mr-2"></i>Vehicle Architecture
            </button>
            <button class="tab-button" onclick="switchTab('network')">
                <i class="fas fa-network-wired mr-2"></i>Network Topology
            </button>
            <button class="tab-button" onclick="switchTab('3d')">
                <i class="fas fa-cube mr-2"></i>3D Rack Viewer
            </button>
        </div>
    </div>

    <!-- Tab Content: Data Center -->
    <div id="tab-datacenter" class="tab-content">
        <div class="grid grid-cols-3 gap-6 mb-6">
            <!-- Rack 1: Frontend -->
            <div class="glass-panel p-6">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-lg font-bold text-white">Rack 1: Frontend</h3>
                    <span class="health-indicator health-good"></span>
                </div>
                
                <div class="rack-server" onclick="selectServer('lb1')">
                    <div class="flex items-center justify-between mb-2">
                        <div class="flex items-center space-x-2">
                            <i class="fas fa-server text-blue-400"></i>
                            <span class="text-white font-semibold">Load Balancer (Active)</span>
                        </div>
                        <span class="health-indicator health-good"></span>
                    </div>
                    <div class="flex space-x-2 mb-2">
                        <span class="hardware-badge badge-cpu">16 Cores</span>
                        <span class="hardware-badge badge-ram">64GB</span>
                    </div>
                    <div class="text-xs text-gray-400">CPU: 23% · RAM: 41% · Network: 2.3 Gbps</div>
                    <div class="power-meter">
                        <div class="power-bar" style="width: 23%"></div>
                    </div>
                </div>

                <div class="rack-server" onclick="selectServer('lb2')">
                    <div class="flex items-center justify-between mb-2">
                        <div class="flex items-center space-x-2">
                            <i class="fas fa-server text-gray-500"></i>
                            <span class="text-white font-semibold">Load Balancer (Standby)</span>
                        </div>
                        <span class="health-indicator health-good"></span>
                    </div>
                    <div class="flex space-x-2 mb-2">
                        <span class="hardware-badge badge-cpu">16 Cores</span>
                        <span class="hardware-badge badge-ram">64GB</span>
                    </div>
                    <div class="text-xs text-gray-400">CPU: 8% · RAM: 22% · Network: 0.5 Gbps</div>
                    <div class="power-meter">
                        <div class="power-bar" style="width: 8%"></div>
                    </div>
                </div>

                <div class="rack-server" onclick="selectServer('gw1')">
                    <div class="flex items-center justify-between mb-2">
                        <div class="flex items-center space-x-2">
                            <i class="fas fa-door-open text-purple-400"></i>
                            <span class="text-white font-semibold">API Gateway #1</span>
                        </div>
                        <span class="health-indicator health-good"></span>
                    </div>
                    <div class="flex space-x-2 mb-2">
                        <span class="hardware-badge badge-cpu">32 Cores</span>
                        <span class="hardware-badge badge-ram">128GB</span>
                    </div>
                    <div class="text-xs text-gray-400">CPU: 45% · RAM: 56% · Network: 4.1 Gbps</div>
                    <div class="power-meter">
                        <div class="power-bar" style="width: 45%"></div>
                    </div>
                </div>

                <div class="rack-server" onclick="selectServer('gw2')">
                    <div class="flex items-center justify-between mb-2">
                        <div class="flex items-center space-x-2">
                            <i class="fas fa-door-open text-purple-400"></i>
                            <span class="text-white font-semibold">API Gateway #2</span>
                        </div>
                        <span class="health-indicator health-good"></span>
                    </div>
                    <div class="flex space-x-2 mb-2">
                        <span class="hardware-badge badge-cpu">32 Cores</span>
                        <span class="hardware-badge badge-ram">128GB</span>
                    </div>
                    <div class="text-xs text-gray-400">CPU: 38% · RAM: 51% · Network: 3.8 Gbps</div>
                    <div class="power-meter">
                        <div class="power-bar" style="width: 38%"></div>
                    </div>
                </div>
            </div>

            <!-- Rack 2: Backend -->
            <div class="glass-panel p-6">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-lg font-bold text-white">Rack 2: Backend</h3>
                    <span class="health-indicator health-good"></span>
                </div>
                
                <div class="rack-server" onclick="selectServer('api1')">
                    <div class="flex items-center justify-between mb-2">
                        <div class="flex items-center space-x-2">
                            <i class="fas fa-cogs text-cyan-400"></i>
                            <span class="text-white font-semibold">FleetFlag API #1</span>
                        </div>
                        <span class="health-indicator health-good"></span>
                    </div>
                    <div class="flex space-x-2 mb-2">
                        <span class="hardware-badge badge-cpu">64 Cores</span>
                        <span class="hardware-badge badge-ram">256GB</span>
                    </div>
                    <div class="text-xs text-gray-400">CPU: 52% · RAM: 68% · Network: 5.2 Gbps</div>
                    <div class="power-meter">
                        <div class="power-bar" style="width: 52%"></div>
                    </div>
                </div>

                <div class="rack-server" onclick="selectServer('api2')">
                    <div class="flex items-center justify-between mb-2">
                        <div class="flex items-center space-x-2">
                            <i class="fas fa-cogs text-cyan-400"></i>
                            <span class="text-white font-semibold">FleetFlag API #2</span>
                        </div>
                        <span class="health-indicator health-good"></span>
                    </div>
                    <div class="flex space-x-2 mb-2">
                        <span class="hardware-badge badge-cpu">64 Cores</span>
                        <span class="hardware-badge badge-ram">256GB</span>
                    </div>
                    <div class="text-xs text-gray-400">CPU: 49% · RAM: 64% · Network: 4.9 Gbps</div>
                    <div class="power-meter">
                        <div class="power-bar" style="width: 49%"></div>
                    </div>
                </div>

                <div class="rack-server" onclick="selectServer('flipt1')">
                    <div class="flex items-center justify-between mb-2">
                        <div class="flex items-center space-x-2">
                            <i class="fas fa-flag text-green-400"></i>
                            <span class="text-white font-semibold">Flipt Engine #1</span>
                        </div>
                        <span class="health-indicator health-good"></span>
                    </div>
                    <div class="flex space-x-2 mb-2">
                        <span class="hardware-badge badge-cpu">32 Cores</span>
                        <span class="hardware-badge badge-ram">128GB</span>
                    </div>
                    <div class="text-xs text-gray-400">CPU: 34% · RAM: 45% · Network: 2.8 Gbps</div>
                    <div class="power-meter">
                        <div class="power-bar" style="width: 34%"></div>
                    </div>
                </div>

                <div class="rack-server" onclick="selectServer('flipt2')">
                    <div class="flex items-center justify-between mb-2">
                        <div class="flex items-center space-x-2">
                            <i class="fas fa-flag text-green-400"></i>
                            <span class="text-white font-semibold">Flipt Engine #2</span>
                        </div>
                        <span class="health-indicator health-good"></span>
                    </div>
                    <div class="flex space-x-2 mb-2">
                        <span class="hardware-badge badge-cpu">32 Cores</span>
                        <span class="hardware-badge badge-ram">128GB</span>
                    </div>
                    <div class="text-xs text-gray-400">CPU: 31% · RAM: 42% · Network: 2.6 Gbps</div>
                    <div class="power-meter">
                        <div class="power-bar" style="width: 31%"></div>
                    </div>
                </div>
            </div>

            <!-- Rack 3: Data -->
            <div class="glass-panel p-6">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-lg font-bold text-white">Rack 3: Data</h3>
                    <span class="health-indicator health-good"></span>
                </div>
                
                <div class="rack-server" onclick="selectServer('pg1')">
                    <div class="flex items-center justify-between mb-2">
                        <div class="flex items-center space-x-2">
                            <i class="fas fa-database text-blue-400"></i>
                            <span class="text-white font-semibold">PostgreSQL Primary</span>
                        </div>
                        <span class="health-indicator health-good"></span>
                    </div>
                    <div class="flex space-x-2 mb-2">
                        <span class="hardware-badge badge-cpu">64 Cores</span>
                        <span class="hardware-badge badge-ram">512GB</span>
                        <span class="hardware-badge badge-storage">8TB SSD</span>
                    </div>
                    <div class="text-xs text-gray-400">CPU: 41% · RAM: 73% · Disk I/O: 1.2 GB/s</div>
                    <div class="power-meter">
                        <div class="power-bar" style="width: 41%"></div>
                    </div>
                </div>

                <div class="rack-server" onclick="selectServer('pg2')">
                    <div class="flex items-center justify-between mb-2">
                        <div class="flex items-center space-x-2">
                            <i class="fas fa-database text-gray-500"></i>
                            <span class="text-white font-semibold">PostgreSQL Standby</span>
                        </div>
                        <span class="health-indicator health-good"></span>
                    </div>
                    <div class="flex space-x-2 mb-2">
                        <span class="hardware-badge badge-cpu">64 Cores</span>
                        <span class="hardware-badge badge-ram">512GB</span>
                        <span class="hardware-badge badge-storage">8TB SSD</span>
                    </div>
                    <div class="text-xs text-gray-400">CPU: 15% · RAM: 68% · Disk I/O: 0.3 GB/s</div>
                    <div class="power-meter">
                        <div class="power-bar" style="width: 15%"></div>
                    </div>
                </div>

                <div class="rack-server" onclick="selectServer('redis1')">
                    <div class="flex items-center justify-between mb-2">
                        <div class="flex items-center space-x-2">
                            <i class="fas fa-memory text-red-400"></i>
                            <span class="text-white font-semibold">Redis Cluster #1</span>
                        </div>
                        <span class="health-indicator health-good"></span>
                    </div>
                    <div class="flex space-x-2 mb-2">
                        <span class="hardware-badge badge-cpu">32 Cores</span>
                        <span class="hardware-badge badge-ram">256GB</span>
                    </div>
                    <div class="text-xs text-gray-400">CPU: 28% · RAM: 82% · Ops/sec: 125k</div>
                    <div class="power-meter">
                        <div class="power-bar" style="width: 28%"></div>
                    </div>
                </div>

                <div class="rack-server" onclick="selectServer('clickhouse1')">
                    <div class="flex items-center justify-between mb-2">
                        <div class="flex items-center space-x-2">
                            <i class="fas fa-chart-line text-yellow-400"></i>
                            <span class="text-white font-semibold">ClickHouse</span>
                        </div>
                        <span class="health-indicator health-good"></span>
                    </div>
                    <div class="flex space-x-2 mb-2">
                        <span class="hardware-badge badge-cpu">64 Cores</span>
                        <span class="hardware-badge badge-ram">512GB</span>
                        <span class="hardware-badge badge-storage">12TB SSD</span>
                    </div>
                    <div class="text-xs text-gray-400">CPU: 36% · RAM: 61% · Queries/sec: 2.4k</div>
                    <div class="power-meter">
                        <div class="power-bar" style="width: 36%"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Server Detail Panel -->
        <div id="server-detail" class="glass-panel p-6" style="display: none;">
            <h3 class="text-xl font-bold text-white mb-4">
                <i class="fas fa-server mr-2 text-cyan-400"></i>
                <span id="detail-server-name">Server Details</span>
            </h3>
            <div class="grid grid-cols-2 gap-6">
                <div>
                    <h4 class="text-sm font-semibold text-gray-400 mb-3">Hardware Specifications</h4>
                    <div class="spec-row">
                        <span class="spec-label">CPU Model</span>
                        <span class="spec-value" id="detail-cpu-model">-</span>
                    </div>
                    <div class="spec-row">
                        <span class="spec-label">CPU Cores</span>
                        <span class="spec-value" id="detail-cpu-cores">-</span>
                    </div>
                    <div class="spec-row">
                        <span class="spec-label">RAM</span>
                        <span class="spec-value" id="detail-ram">-</span>
                    </div>
                    <div class="spec-row">
                        <span class="spec-label">Storage</span>
                        <span class="spec-value" id="detail-storage">-</span>
                    </div>
                    <div class="spec-row">
                        <span class="spec-label">Network</span>
                        <span class="spec-value" id="detail-network">-</span>
                    </div>
                    <div class="spec-row">
                        <span class="spec-label">Power Consumption</span>
                        <span class="spec-value" id="detail-power">-</span>
                    </div>
                </div>
                <div>
                    <h4 class="text-sm font-semibold text-gray-400 mb-3">Current Status</h4>
                    <div class="spec-row">
                        <span class="spec-label">CPU Usage</span>
                        <span class="spec-value" id="detail-cpu-usage">-</span>
                    </div>
                    <div class="spec-row">
                        <span class="spec-label">RAM Usage</span>
                        <span class="spec-value" id="detail-ram-usage">-</span>
                    </div>
                    <div class="spec-row">
                        <span class="spec-label">Disk I/O</span>
                        <span class="spec-value" id="detail-disk-io">-</span>
                    </div>
                    <div class="spec-row">
                        <span class="spec-label">Network Throughput</span>
                        <span class="spec-value" id="detail-network-throughput">-</span>
                    </div>
                    <div class="spec-row">
                        <span class="spec-label">Uptime</span>
                        <span class="spec-value" id="detail-uptime">-</span>
                    </div>
                    <div class="spec-row">
                        <span class="spec-label">Health Status</span>
                        <span class="spec-value text-green-400" id="detail-health">Healthy</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Tab Content: Vehicle -->
    <div id="tab-vehicle" class="tab-content" style="display: none;">
        <div class="grid grid-cols-2 gap-6">
            <!-- Vehicle Diagram -->
            <div class="glass-panel p-6">
                <h3 class="text-lg font-bold text-white mb-4">
                    <i class="fas fa-car mr-2"></i>Vehicle Architecture (Genesis GV80)
                </h3>
                <div class="vehicle-diagram">
                    <!-- Connection Lines -->
                    <div class="connection-line line-hpc-ccu"></div>
                    <div class="connection-line line-ccu-ecu"></div>

                    <!-- HPC Component -->
                    <div class="vehicle-component component-hpc" onclick="selectVehicleComponent('hpc')">
                        <i class="fas fa-microchip text-2xl mb-2"></i>
                        <div class="font-semibold">HPC</div>
                        <div class="text-xs text-gray-400">High Performance Computer</div>
                    </div>

                    <!-- CCU Component -->
                    <div class="vehicle-component component-ccu" onclick="selectVehicleComponent('ccu')">
                        <i class="fas fa-server text-2xl mb-2"></i>
                        <div class="font-semibold">CCU</div>
                        <div class="text-xs text-gray-400">Central Computing Unit</div>
                    </div>

                    <!-- ECU Components -->
                    <div class="vehicle-component component-ecu ecu-adas" onclick="selectVehicleComponent('adas')">
                        <i class="fas fa-eye text-xl mb-2"></i>
                        <div class="font-semibold text-sm">ADAS ECU</div>
                    </div>

                    <div class="vehicle-component component-ecu ecu-cluster" onclick="selectVehicleComponent('cluster')">
                        <i class="fas fa-tachometer-alt text-xl mb-2"></i>
                        <div class="font-semibold text-sm">Cluster ECU</div>
                    </div>

                    <div class="vehicle-component component-ecu ecu-tcu" onclick="selectVehicleComponent('tcu')">
                        <i class="fas fa-broadcast-tower text-xl mb-2"></i>
                        <div class="font-semibold text-sm">TCU ECU</div>
                    </div>

                    <!-- Labels -->
                    <div style="position: absolute; top: 140px; left: 50%; transform: translateX(-50%); font-size: 0.75rem; color: #94a3b8;">
                        Ethernet 100Mbps
                    </div>
                    <div style="position: absolute; top: 270px; left: 50%; transform: translateX(-50%); font-size: 0.75rem; color: #94a3b8;">
                        CAN Bus 500kbps
                    </div>
                </div>
            </div>

            <!-- Vehicle Component Detail -->
            <div class="glass-panel p-6">
                <h3 class="text-lg font-bold text-white mb-4">
                    <span id="vehicle-component-name">Component Details</span>
                </h3>
                <div id="vehicle-component-detail">
                    <div class="text-center text-gray-400 py-12">
                        <i class="fas fa-mouse-pointer text-4xl mb-4"></i>
                        <p>차량 컴포넌트를 클릭하여 상세 정보를 확인하세요</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Tab Content: Network -->
    <div id="tab-network" class="tab-content" style="display: none;">
        <div class="glass-panel p-6">
            <h3 class="text-lg font-bold text-white mb-4">
                <i class="fas fa-network-wired mr-2"></i>Network Topology (IDC ↔ Vehicle)
            </h3>
            <div style="position: relative; height: 600px; background: rgba(15, 23, 42, 0.5); border-radius: 12px; padding: 40px;">
                <!-- Internet Cloud -->
                <div class="topology-node" style="top: 20px; left: 50%; transform: translateX(-50%); width: 120px; height: 60px; border-radius: 30px; background: rgba(100, 116, 139, 0.2); border-color: #64748b; color: #cbd5e1;">
                    <i class="fas fa-cloud text-xl mr-2"></i>Internet
                </div>

                <!-- Azure Front Door -->
                <div class="topology-node node-idc" style="top: 120px; left: 50%; transform: translateX(-50%);" onclick="selectNetworkNode('azure')">
                    <div>
                        <i class="fas fa-door-open text-2xl mb-1"></i>
                        <div class="text-xs">Azure<br>Front Door</div>
                    </div>
                </div>

                <!-- IDC Firewall -->
                <div class="topology-node node-idc" style="top: 240px; left: 50%; transform: translateX(-50%);" onclick="selectNetworkNode('firewall')">
                    <div>
                        <i class="fas fa-shield-alt text-2xl mb-1"></i>
                        <div class="text-xs">IDC<br>Firewall</div>
                    </div>
                </div>

                <!-- DMZ Zone -->
                <div class="topology-node node-idc" style="top: 360px; left: 25%; transform: translateX(-50%);" onclick="selectNetworkNode('dmz')">
                    <div>
                        <i class="fas fa-shield text-2xl mb-1"></i>
                        <div class="text-xs">DMZ<br>Zone</div>
                    </div>
                </div>

                <!-- App Zone -->
                <div class="topology-node node-idc" style="top: 360px; left: 75%; transform: translateX(-50%);" onclick="selectNetworkNode('app')">
                    <div>
                        <i class="fas fa-cogs text-2xl mb-1"></i>
                        <div class="text-xs">App<br>Zone</div>
                    </div>
                </div>

                <!-- Vehicle CCU -->
                <div class="topology-node node-vehicle" style="top: 480px; left: 50%; transform: translateX(-50%);" onclick="selectNetworkNode('ccu')">
                    <div>
                        <i class="fas fa-car text-2xl mb-1"></i>
                        <div class="text-xs">Vehicle<br>CCU</div>
                    </div>
                </div>

                <!-- Connection Labels -->
                <div style="position: absolute; top: 90px; left: 50%; transform: translateX(-50%); font-size: 0.75rem; color: #00aad2; background: rgba(0, 170, 210, 0.1); padding: 4px 8px; border-radius: 4px;">
                    HTTPS/WSS
                </div>
                <div style="position: absolute; top: 210px; left: 50%; transform: translateX(-50%); font-size: 0.75rem; color: #00aad2; background: rgba(0, 170, 210, 0.1); padding: 4px 8px; border-radius: 4px;">
                    VPN IPsec
                </div>
                <div style="position: absolute; top: 310px; left: 37%; font-size: 0.75rem; color: #00aad2; background: rgba(0, 170, 210, 0.1); padding: 4px 8px; border-radius: 4px;">
                    TLS 1.3
                </div>
                <div style="position: absolute; top: 310px; right: 37%; font-size: 0.75rem; color: #00aad2; background: rgba(0, 170, 210, 0.1); padding: 4px 8px; border-radius: 4px;">
                    Private
                </div>
                <div style="position: absolute; top: 430px; left: 50%; transform: translateX(-50%); font-size: 0.75rem; color: #00aad2; background: rgba(0, 170, 210, 0.1); padding: 4px 8px; border-radius: 4px;">
                    LTE/5G + VPN
                </div>

                <!-- Network Stats -->
                <div style="position: absolute; bottom: 20px; left: 20px; right: 20px;">
                    <div class="grid grid-cols-4 gap-4">
                        <div class="text-center">
                            <div class="text-2xl font-bold text-cyan-400">2.3 Gbps</div>
                            <div class="text-xs text-gray-400">Total Throughput</div>
                        </div>
                        <div class="text-center">
                            <div class="text-2xl font-bold text-green-400">8.2 ms</div>
                            <div class="text-xs text-gray-400">Avg Latency</div>
                        </div>
                        <div class="text-center">
                            <div class="text-2xl font-bold text-blue-400">125,847</div>
                            <div class="text-xs text-gray-400">Active Connections</div>
                        </div>
                        <div class="text-center">
                            <div class="text-2xl font-bold text-purple-400">99.98%</div>
                            <div class="text-xs text-gray-400">Uptime</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Network Node Detail -->
            <div id="network-detail" class="glass-panel p-6 mt-6" style="display: none;">
                <h3 class="text-xl font-bold text-white mb-4">
                    <span id="network-node-name">Network Node Details</span>
                </h3>
                <div id="network-node-detail"></div>
            </div>
        </div>
    </div>

    <!-- Tab Content: 3D Viewer -->
    <div id="tab-3d" class="tab-content" style="display: none;">
        <div class="glass-panel p-6">
            <h3 class="text-lg font-bold text-white mb-4">
                <i class="fas fa-cube mr-2"></i>3D Data Center Rack Viewer
            </h3>
            <div class="mb-4 flex space-x-4">
                <button onclick="rotate3DView('left')" class="bg-cyan-500 hover:bg-cyan-600 text-white px-4 py-2 rounded-lg">
                    <i class="fas fa-arrow-left mr-2"></i>Rotate Left
                </button>
                <button onclick="rotate3DView('right')" class="bg-cyan-500 hover:bg-cyan-600 text-white px-4 py-2 rounded-lg">
                    <i class="fas fa-arrow-right mr-2"></i>Rotate Right
                </button>
                <button onclick="reset3DView()" class="bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-lg">
                    <i class="fas fa-sync-alt mr-2"></i>Reset View
                </button>
            </div>
            <div id="canvas3d"></div>
            <div class="mt-4 text-sm text-gray-400">
                <i class="fas fa-info-circle mr-2"></i>
                마우스 드래그로 회전, 휠로 확대/축소가 가능합니다
            </div>
        </div>
    </div>

    <script>
        // Server Specifications Database
        const serverSpecs = {
            lb1: {
                name: 'Load Balancer (Active)',
                cpu: 'AMD EPYC 7543 32-Core',
                cores: '16 Cores (32 Threads)',
                ram: '64GB DDR4 3200MHz',
                storage: '2TB NVMe SSD (RAID 1)',
                network: '10 Gbps Ethernet',
                power: '350W',
                cpuUsage: '23%',
                ramUsage: '41%',
                diskIO: '450 MB/s',
                networkThroughput: '2.3 Gbps',
                uptime: '127 days',
                health: 'Healthy'
            },
            lb2: {
                name: 'Load Balancer (Standby)',
                cpu: 'AMD EPYC 7543 32-Core',
                cores: '16 Cores (32 Threads)',
                ram: '64GB DDR4 3200MHz',
                storage: '2TB NVMe SSD (RAID 1)',
                network: '10 Gbps Ethernet',
                power: '180W',
                cpuUsage: '8%',
                ramUsage: '22%',
                diskIO: '120 MB/s',
                networkThroughput: '0.5 Gbps',
                uptime: '127 days',
                health: 'Healthy'
            },
            gw1: {
                name: 'API Gateway #1',
                cpu: 'Intel Xeon Gold 6338 32-Core',
                cores: '32 Cores (64 Threads)',
                ram: '128GB DDR4 3200MHz',
                storage: '4TB NVMe SSD (RAID 10)',
                network: '25 Gbps Ethernet',
                power: '580W',
                cpuUsage: '45%',
                ramUsage: '56%',
                diskIO: '1.2 GB/s',
                networkThroughput: '4.1 Gbps',
                uptime: '89 days',
                health: 'Healthy'
            },
            gw2: {
                name: 'API Gateway #2',
                cpu: 'Intel Xeon Gold 6338 32-Core',
                cores: '32 Cores (64 Threads)',
                ram: '128GB DDR4 3200MHz',
                storage: '4TB NVMe SSD (RAID 10)',
                network: '25 Gbps Ethernet',
                power: '550W',
                cpuUsage: '38%',
                ramUsage: '51%',
                diskIO: '1.0 GB/s',
                networkThroughput: '3.8 Gbps',
                uptime: '89 days',
                health: 'Healthy'
            },
            api1: {
                name: 'FleetFlag API Server #1',
                cpu: 'AMD EPYC 7763 64-Core',
                cores: '64 Cores (128 Threads)',
                ram: '256GB DDR4 3200MHz',
                storage: '8TB NVMe SSD (RAID 10)',
                network: '25 Gbps Ethernet',
                power: '780W',
                cpuUsage: '52%',
                ramUsage: '68%',
                diskIO: '2.1 GB/s',
                networkThroughput: '5.2 Gbps',
                uptime: '64 days',
                health: 'Healthy'
            },
            api2: {
                name: 'FleetFlag API Server #2',
                cpu: 'AMD EPYC 7763 64-Core',
                cores: '64 Cores (128 Threads)',
                ram: '256GB DDR4 3200MHz',
                storage: '8TB NVMe SSD (RAID 10)',
                network: '25 Gbps Ethernet',
                power: '750W',
                cpuUsage: '49%',
                ramUsage: '64%',
                diskIO: '1.9 GB/s',
                networkThroughput: '4.9 Gbps',
                uptime: '64 days',
                health: 'Healthy'
            },
            flipt1: {
                name: 'Flipt Engine #1',
                cpu: 'Intel Xeon Gold 6338 32-Core',
                cores: '32 Cores (64 Threads)',
                ram: '128GB DDR4 3200MHz',
                storage: '4TB NVMe SSD (RAID 10)',
                network: '25 Gbps Ethernet',
                power: '480W',
                cpuUsage: '34%',
                ramUsage: '45%',
                diskIO: '850 MB/s',
                networkThroughput: '2.8 Gbps',
                uptime: '64 days',
                health: 'Healthy'
            },
            flipt2: {
                name: 'Flipt Engine #2',
                cpu: 'Intel Xeon Gold 6338 32-Core',
                cores: '32 Cores (64 Threads)',
                ram: '128GB DDR4 3200MHz',
                storage: '4TB NVMe SSD (RAID 10)',
                network: '25 Gbps Ethernet',
                power: '460W',
                cpuUsage: '31%',
                ramUsage: '42%',
                diskIO: '780 MB/s',
                networkThroughput: '2.6 Gbps',
                uptime: '64 days',
                health: 'Healthy'
            },
            pg1: {
                name: 'PostgreSQL Primary',
                cpu: 'AMD EPYC 7763 64-Core',
                cores: '64 Cores (128 Threads)',
                ram: '512GB DDR4 3200MHz',
                storage: '8TB NVMe SSD (RAID 10)',
                network: '25 Gbps Ethernet',
                power: '820W',
                cpuUsage: '41%',
                ramUsage: '73%',
                diskIO: '1.2 GB/s',
                networkThroughput: '3.4 Gbps',
                uptime: '127 days',
                health: 'Healthy'
            },
            pg2: {
                name: 'PostgreSQL Standby',
                cpu: 'AMD EPYC 7763 64-Core',
                cores: '64 Cores (128 Threads)',
                ram: '512GB DDR4 3200MHz',
                storage: '8TB NVMe SSD (RAID 10)',
                network: '25 Gbps Ethernet',
                power: '480W',
                cpuUsage: '15%',
                ramUsage: '68%',
                diskIO: '0.3 GB/s',
                networkThroughput: '1.2 Gbps',
                uptime: '127 days',
                health: 'Healthy'
            },
            redis1: {
                name: 'Redis Cluster #1',
                cpu: 'Intel Xeon Gold 6338 32-Core',
                cores: '32 Cores (64 Threads)',
                ram: '256GB DDR4 3200MHz',
                storage: '4TB NVMe SSD (RAID 1)',
                network: '25 Gbps Ethernet',
                power: '420W',
                cpuUsage: '28%',
                ramUsage: '82%',
                diskIO: '650 MB/s',
                networkThroughput: '2.1 Gbps',
                uptime: '89 days',
                health: 'Healthy'
            },
            clickhouse1: {
                name: 'ClickHouse Analytics',
                cpu: 'AMD EPYC 7763 64-Core',
                cores: '64 Cores (128 Threads)',
                ram: '512GB DDR4 3200MHz',
                storage: '12TB NVMe SSD (RAID 10)',
                network: '25 Gbps Ethernet',
                power: '680W',
                cpuUsage: '36%',
                ramUsage: '61%',
                diskIO: '1.8 GB/s',
                networkThroughput: '4.2 Gbps',
                uptime: '64 days',
                health: 'Healthy'
            }
        };

        // Vehicle Component Specs
        const vehicleSpecs = {
            hpc: {
                name: 'HPC (High Performance Computer)',
                description: 'SDV 핵심 컴퓨팅 유닛 - Feature Flag Agent 실행',
                hardware: {
                    'Processor': 'NVIDIA Tegra Xavier (8-core ARM + GPU)',
                    'RAM': '32GB LPDDR4X',
                    'Storage': '256GB UFS 3.1',
                    'OS': 'Ubuntu 20.04 LTS (Real-Time Kernel)',
                    'Container Runtime': 'Kubernetes 1.28',
                    'Network': 'Ethernet 1Gbps (TSN)'
                },
                software: {
                    'FleetFlag Agent': 'v2.1.0 (Rust SDK)',
                    'OpenFeature SDK': 'v1.5.0',
                    'SQLite Cache': '7-day retention',
                    'gRPC Client': 'Bidirectional sync',
                    'Safety Gatekeeper': 'ASIL-D certified'
                },
                metrics: {
                    'CPU Usage': '18%',
                    'RAM Usage': '12GB / 32GB (38%)',
                    'Cache Hit Rate': '97.8%',
                    'Sync Latency': '8.2ms',
                    'Power Consumption': '45W'
                }
            },
            ccu: {
                name: 'CCU (Central Computing Unit)',
                description: 'Gateway - IDC 연결 및 CAN 브릿지',
                hardware: {
                    'Processor': 'NXP i.MX 8 QuadMax (Cortex-A72)',
                    'RAM': '8GB LPDDR4',
                    'Storage': '64GB eMMC',
                    'LTE/5G Modem': 'Qualcomm X55 5G',
                    'CAN Controller': 'Dual CAN-FD',
                    'Network': 'Ethernet 100Mbps'
                },
                software: {
                    'Sync Agent': 'v1.8.2 (Go)',
                    'VPN Client': 'WireGuard',
                    'TLS Stack': 'OpenSSL 3.0',
                    'CAN Gateway': 'Vector CANoe-compatible'
                },
                metrics: {
                    'CPU Usage': '34%',
                    'RAM Usage': '3.2GB / 8GB (40%)',
                    'Network Uplink': '450 kbps',
                    'CAN Traffic': '125 msg/sec',
                    'Power Consumption': '12W'
                }
            },
            adas: {
                name: 'ADAS ECU',
                description: 'Advanced Driver Assistance System',
                hardware: {
                    'Processor': 'Renesas R-Car V3H',
                    'RAM': '4GB LPDDR4',
                    'Sensors': 'Camera (8), Radar (5), LiDAR (1)',
                    'CAN': 'CAN-FD 5Mbps'
                },
                features: [
                    'Lane Keeping Assist (LKA)',
                    'Adaptive Cruise Control (ACC)',
                    'Autonomous Emergency Braking (AEB)',
                    'Blind Spot Detection (BSD)'
                ],
                flags: {
                    'feature_adas_lka_enhanced': 'Enabled (95% rollout)',
                    'feature_adas_acc_v2': 'Canary (5% rollout)',
                    'feature_adas_aeb_sensitive': 'Disabled (Safety review)'
                }
            },
            cluster: {
                name: 'Cluster ECU',
                description: 'Digital Instrument Cluster',
                hardware: {
                    'Processor': 'TI Jacinto DRA829',
                    'RAM': '2GB LPDDR4',
                    'Display': '12.3" TFT LCD (1920x720)',
                    'CAN': 'CAN 2.0B 500kbps'
                },
                features: [
                    'Speedometer / Tachometer',
                    'Navigation Display',
                    'ADAS Status Indicators',
                    'Warning Alerts'
                ],
                flags: {
                    'feature_cluster_theme_dark': 'Enabled (100%)',
                    'feature_cluster_hud_enhanced': 'Enabled (80% rollout)',
                    'feature_cluster_nav_3d': 'A/B Test (50/50)'
                }
            },
            tcu: {
                name: 'TCU (Telematics Control Unit)',
                description: 'Vehicle Connectivity Gateway',
                hardware: {
                    'Processor': 'Qualcomm SA8155P',
                    'RAM': '8GB LPDDR4X',
                    'LTE/5G': 'Qualcomm X55 5G',
                    'Wi-Fi': '802.11ax (Wi-Fi 6)',
                    'Bluetooth': '5.2',
                    'GPS': 'Multi-GNSS (GPS, GLONASS, Galileo, BeiDou)'
                },
                features: [
                    'OTA Update Management',
                    'Remote Vehicle Control',
                    'Stolen Vehicle Tracking',
                    'eCall (Emergency Call)'
                ],
                flags: {
                    'feature_tcu_ota_differential': 'Enabled (100%)',
                    'feature_tcu_remote_start': 'Enabled (Regional)',
                    'feature_tcu_ecall_test': 'Canary (1% rollout)'
                }
            }
        };

        // Network Node Specs
        const networkNodes = {
            azure: {
                name: 'Azure Front Door',
                type: 'CDN & DDoS Protection',
                specs: {
                    'Provider': 'Microsoft Azure',
                    'Regions': '60+ global PoPs',
                    'SSL Termination': 'TLS 1.3',
                    'WAF': 'OWASP Top 10 protection',
                    'DDoS Protection': 'Up to 2 Tbps'
                },
                metrics: {
                    'Requests/sec': '24,500',
                    'Avg Latency': '12ms',
                    'Cache Hit Rate': '94.2%',
                    'Bandwidth': '2.8 Gbps'
                }
            },
            firewall: {
                name: 'Hyundai IDC Firewall',
                type: 'Next-Gen Firewall (NGFW)',
                specs: {
                    'Model': 'Palo Alto PA-5260',
                    'Throughput': '50 Gbps',
                    'Concurrent Sessions': '10M',
                    'IPS': 'Enabled',
                    'SSL Decryption': 'Selective'
                },
                rules: {
                    'Total Rules': '1,248',
                    'Allow Rules': '847',
                    'Block Rules': '401',
                    'Blocked IPs (24h)': '12,457'
                }
            },
            dmz: {
                name: 'DMZ Zone',
                type: 'Demilitarized Zone',
                components: [
                    'Load Balancers (Active/Standby)',
                    'API Gateways (2x)',
                    'Reverse Proxy (Nginx)',
                    'Rate Limiter (Redis)'
                ],
                security: {
                    'Access Control': 'IP Whitelist only',
                    'Auth': 'mTLS + JWT',
                    'Rate Limit': '10,000 req/min per IP',
                    'Monitoring': 'Azure Sentinel'
                }
            },
            app: {
                name: 'Application Zone',
                type: 'Private Network',
                components: [
                    'FleetFlag API Servers (2x)',
                    'Flipt Engines (2x)',
                    'PostgreSQL Cluster (Primary + Standby)',
                    'Redis Cache Cluster (3 nodes)',
                    'ClickHouse Analytics'
                ],
                security: {
                    'Network': '10.0.0.0/16 (RFC1918)',
                    'Access': 'DMZ Zone only',
                    'Encryption': 'IPsec (internal)',
                    'Monitoring': 'Prometheus + Grafana'
                }
            },
            ccu: {
                name: 'Vehicle CCU',
                type: 'In-Vehicle Gateway',
                connection: {
                    'Uplink': 'LTE Cat.12 / 5G NSA',
                    'VPN': 'WireGuard tunnel to IDC',
                    'Encryption': 'AES-256-GCM',
                    'Compression': 'gzip (level 6)',
                    'Heartbeat': 'Every 30 seconds'
                },
                metrics: {
                    'Active Vehicles': '125,847',
                    'Avg RTT': '45ms',
                    'Data Usage': '2.3 MB/day per vehicle',
                    'Sync Success Rate': '99.6%'
                }
            }
        };

        // Tab Switching
        function switchTab(tabName) {
            // Hide all tabs
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.style.display = 'none';
            });

            // Remove active class from all buttons
            document.querySelectorAll('.tab-button').forEach(btn => {
                btn.classList.remove('active');
            });

            // Show selected tab
            document.getElementById('tab-' + tabName).style.display = 'block';

            // Add active class to clicked button
            event.target.closest('.tab-button').classList.add('active');

            // Initialize 3D view if needed
            if (tabName === '3d' && !window.scene) {
                init3DView();
            }
        }

        // Select Server
        function selectServer(serverId) {
            const spec = serverSpecs[serverId];
            if (!spec) return;

            // Remove active class from all servers
            document.querySelectorAll('.rack-server').forEach(s => {
                s.classList.remove('active');
            });

            // Add active class to clicked server
            event.target.closest('.rack-server').classList.add('active');

            // Update detail panel
            document.getElementById('detail-server-name').textContent = spec.name;
            document.getElementById('detail-cpu-model').textContent = spec.cpu;
            document.getElementById('detail-cpu-cores').textContent = spec.cores;
            document.getElementById('detail-ram').textContent = spec.ram;
            document.getElementById('detail-storage').textContent = spec.storage;
            document.getElementById('detail-network').textContent = spec.network;
            document.getElementById('detail-power').textContent = spec.power;
            document.getElementById('detail-cpu-usage').textContent = spec.cpuUsage;
            document.getElementById('detail-ram-usage').textContent = spec.ramUsage;
            document.getElementById('detail-disk-io').textContent = spec.diskIO;
            document.getElementById('detail-network-throughput').textContent = spec.networkThroughput;
            document.getElementById('detail-uptime').textContent = spec.uptime;
            document.getElementById('detail-health').textContent = spec.health;

            // Show detail panel
            document.getElementById('server-detail').style.display = 'block';
            document.getElementById('server-detail').scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }

        // Select Vehicle Component
        function selectVehicleComponent(componentId) {
            const spec = vehicleSpecs[componentId];
            if (!spec) return;

            document.getElementById('vehicle-component-name').innerHTML = 
                `<i class="fas fa-microchip mr-2 text-cyan-400"></i>${spec.name}`;

            let html = `<div class="text-sm text-gray-400 mb-4">${spec.description}</div>`;

            if (spec.hardware) {
                html += '<h4 class="text-sm font-semibold text-gray-400 mb-3">Hardware Specifications</h4>';
                for (const [key, value] of Object.entries(spec.hardware)) {
                    html += `<div class="spec-row"><span class="spec-label">${key}</span><span class="spec-value">${value}</span></div>`;
                }
            }

            if (spec.software) {
                html += '<h4 class="text-sm font-semibold text-gray-400 mb-3 mt-4">Software Stack</h4>';
                for (const [key, value] of Object.entries(spec.software)) {
                    html += `<div class="spec-row"><span class="spec-label">${key}</span><span class="spec-value">${value}</span></div>`;
                }
            }

            if (spec.features) {
                html += '<h4 class="text-sm font-semibold text-gray-400 mb-3 mt-4">Features</h4>';
                html += '<ul class="space-y-2">';
                spec.features.forEach(feature => {
                    html += `<li class="text-sm text-gray-300"><i class="fas fa-check-circle text-green-400 mr-2"></i>${feature}</li>`;
                });
                html += '</ul>';
            }

            if (spec.flags) {
                html += '<h4 class="text-sm font-semibold text-gray-400 mb-3 mt-4">Active Feature Flags</h4>';
                for (const [key, value] of Object.entries(spec.flags)) {
                    const color = value.includes('Enabled') ? 'green' : value.includes('Canary') ? 'yellow' : 'red';
                    html += `<div class="spec-row">
                        <span class="spec-label font-mono text-xs">${key}</span>
                        <span class="spec-value text-${color}-400">${value}</span>
                    </div>`;
                }
            }

            if (spec.metrics) {
                html += '<h4 class="text-sm font-semibold text-gray-400 mb-3 mt-4">Real-time Metrics</h4>';
                for (const [key, value] of Object.entries(spec.metrics)) {
                    html += `<div class="spec-row"><span class="spec-label">${key}</span><span class="spec-value">${value}</span></div>`;
                }
            }

            document.getElementById('vehicle-component-detail').innerHTML = html;
        }

        // Select Network Node
        function selectNetworkNode(nodeId) {
            const node = networkNodes[nodeId];
            if (!node) return;

            document.getElementById('network-node-name').innerHTML = 
                `<i class="fas fa-network-wired mr-2 text-cyan-400"></i>${node.name}`;

            let html = `<div class="text-sm text-cyan-400 mb-4 font-semibold">${node.type}</div>`;

            if (node.specs) {
                html += '<h4 class="text-sm font-semibold text-gray-400 mb-3">Specifications</h4>';
                for (const [key, value] of Object.entries(node.specs)) {
                    html += `<div class="spec-row"><span class="spec-label">${key}</span><span class="spec-value">${value}</span></div>`;
                }
            }

            if (node.components) {
                html += '<h4 class="text-sm font-semibold text-gray-400 mb-3 mt-4">Components</h4>';
                html += '<ul class="space-y-2">';
                node.components.forEach(comp => {
                    html += `<li class="text-sm text-gray-300"><i class="fas fa-server text-cyan-400 mr-2"></i>${comp}</li>`;
                });
                html += '</ul>';
            }

            if (node.security) {
                html += '<h4 class="text-sm font-semibold text-gray-400 mb-3 mt-4">Security</h4>';
                for (const [key, value] of Object.entries(node.security)) {
                    html += `<div class="spec-row"><span class="spec-label">${key}</span><span class="spec-value">${value}</span></div>`;
                }
            }

            if (node.rules) {
                html += '<h4 class="text-sm font-semibold text-gray-400 mb-3 mt-4">Firewall Rules</h4>';
                for (const [key, value] of Object.entries(node.rules)) {
                    html += `<div class="spec-row"><span class="spec-label">${key}</span><span class="spec-value">${value}</span></div>`;
                }
            }

            if (node.connection) {
                html += '<h4 class="text-sm font-semibold text-gray-400 mb-3 mt-4">Connection Details</h4>';
                for (const [key, value] of Object.entries(node.connection)) {
                    html += `<div class="spec-row"><span class="spec-label">${key}</span><span class="spec-value">${value}</span></div>`;
                }
            }

            if (node.metrics) {
                html += '<h4 class="text-sm font-semibold text-gray-400 mb-3 mt-4">Metrics</h4>';
                for (const [key, value] of Object.entries(node.metrics)) {
                    html += `<div class="spec-row"><span class="spec-label">${key}</span><span class="spec-value">${value}</span></div>`;
                }
            }

            document.getElementById('network-node-detail').innerHTML = html;
            document.getElementById('network-detail').style.display = 'block';
            document.getElementById('network-detail').scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }

        // 3D View Functions
        let scene, camera, renderer, controls;
        let rackMeshes = [];

        function init3DView() {
            const container = document.getElementById('canvas3d');
            const width = container.clientWidth;
            const height = 500;

            // Scene
            scene = new THREE.Scene();
            scene.background = new THREE.Color(0x0f172a);
            scene.fog = new THREE.Fog(0x0f172a, 10, 50);

            // Camera
            camera = new THREE.PerspectiveCamera(45, width / height, 0.1, 1000);
            camera.position.set(15, 10, 15);

            // Renderer
            renderer = new THREE.WebGLRenderer({ antialias: true });
            renderer.setSize(width, height);
            renderer.shadowMap.enabled = true;
            container.appendChild(renderer.domElement);

            // Controls
            controls = new THREE.OrbitControls(camera, renderer.domElement);
            controls.enableDamping = true;
            controls.dampingFactor = 0.05;

            // Lights
            const ambientLight = new THREE.AmbientLight(0x404040, 2);
            scene.add(ambientLight);

            const directionalLight = new THREE.DirectionalLight(0xffffff, 1);
            directionalLight.position.set(10, 20, 10);
            directionalLight.castShadow = true;
            scene.add(directionalLight);

            // Grid
            const gridHelper = new THREE.GridHelper(40, 40, 0x00aad2, 0x1e293b);
            scene.add(gridHelper);

            // Create 3 Racks
            createRack(-8, 0, 0, 0x3b82f6, 'Rack 1: Frontend');
            createRack(0, 0, 0, 0x8b5cf6, 'Rack 2: Backend');
            createRack(8, 0, 0, 0x10b981, 'Rack 3: Data');

            // Animation
            animate();
        }

        function createRack(x, y, z, color, label) {
            // Rack frame
            const frameGeometry = new THREE.BoxGeometry(2, 8, 1);
            const frameMaterial = new THREE.MeshPhongMaterial({
                color: 0x1e293b,
                transparent: true,
                opacity: 0.8
            });
            const frame = new THREE.Mesh(frameGeometry, frameMaterial);
            frame.position.set(x, 4, z);
            frame.castShadow = true;
            scene.add(frame);

            // Servers (4 per rack)
            for (let i = 0; i < 4; i++) {
                const serverGeometry = new THREE.BoxGeometry(1.8, 1.5, 0.8);
                const serverMaterial = new THREE.MeshPhongMaterial({
                    color: color,
                    emissive: color,
                    emissiveIntensity: 0.2
                });
                const server = new THREE.Mesh(serverGeometry, serverMaterial);
                server.position.set(x, 1.5 + i * 2, z);
                server.castShadow = true;
                scene.add(server);
                rackMeshes.push(server);

                // LED indicators
                const ledGeometry = new THREE.SphereGeometry(0.05, 16, 16);
                const ledMaterial = new THREE.MeshBasicMaterial({
                    color: 0x10b981,
                    emissive: 0x10b981
                });
                const led = new THREE.Mesh(ledGeometry, ledMaterial);
                led.position.set(x - 0.8, 1.5 + i * 2, z + 0.4);
                scene.add(led);
            }

            // Label
            createTextLabel(label, x, 8.5, z);
        }

        function createTextLabel(text, x, y, z) {
            const canvas = document.createElement('canvas');
            const context = canvas.getContext('2d');
            canvas.width = 512;
            canvas.height = 128;
            context.fillStyle = 'rgba(0, 170, 210, 0.8)';
            context.fillRect(0, 0, canvas.width, canvas.height);
            context.font = 'Bold 48px Arial';
            context.fillStyle = 'white';
            context.textAlign = 'center';
            context.fillText(text, 256, 80);

            const texture = new THREE.CanvasTexture(canvas);
            const spriteMaterial = new THREE.SpriteMaterial({ map: texture });
            const sprite = new THREE.Sprite(spriteMaterial);
            sprite.position.set(x, y, z);
            sprite.scale.set(4, 1, 1);
            scene.add(sprite);
        }

        function animate() {
            requestAnimationFrame(animate);
            controls.update();

            // Pulsing effect for servers
            rackMeshes.forEach((mesh, index) => {
                const time = Date.now() * 0.001;
                mesh.material.emissiveIntensity = 0.2 + Math.sin(time + index * 0.5) * 0.1;
            });

            renderer.render(scene, camera);
        }

        function rotate3DView(direction) {
            if (!camera) return;
            const angle = direction === 'left' ? 0.2 : -0.2;
            const x = camera.position.x;
            const z = camera.position.z;
            camera.position.x = x * Math.cos(angle) - z * Math.sin(angle);
            camera.position.z = x * Math.sin(angle) + z * Math.cos(angle);
            camera.lookAt(0, 4, 0);
        }

        function reset3DView() {
            if (!camera) return;
            camera.position.set(15, 10, 15);
            camera.lookAt(0, 4, 0);
            controls.reset();
        }

        // Window resize
        window.addEventListener('resize', () => {
            if (renderer && camera) {
                const container = document.getElementById('canvas3d');
                const width = container.clientWidth;
                const height = 500;
                camera.aspect = width / height;
                camera.updateProjectionMatrix();
                renderer.setSize(width, height);
            }
        });

        // Auto-update metrics
        setInterval(() => {
            // Simulate real-time updates (optional)
            document.querySelectorAll('.power-bar').forEach(bar => {
                const currentWidth = parseFloat(bar.style.width);
                const change = (Math.random() - 0.5) * 5;
                const newWidth = Math.max(10, Math.min(90, currentWidth + change));
                bar.style.width = newWidth + '%';
            });
        }, 3000);
    </script>
</body>
</html>
