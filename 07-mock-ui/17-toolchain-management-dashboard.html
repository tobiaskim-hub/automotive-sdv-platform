<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FleetFlag - Toolchain Management Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css" rel="stylesheet">
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
        :root {
            --primary: #002c5f;
            --secondary: #00aad2;
            --danger: #dc2626;
            --warning: #f59e0b;
            --success: #10b981;
            --purple: #8b5cf6;
            --indigo: #6366f1;
        }

        body {
            background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            color: #f1f5f9;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
        }

        .glass-card {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            padding: 24px;
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.37);
        }

        #network-container {
            width: 100%;
            height: 800px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 16px;
            position: relative;
            overflow: hidden;
        }

        .node-label {
            font-size: 11px;
            font-weight: 600;
            fill: #fff;
            text-anchor: middle;
            pointer-events: none;
            text-shadow: 0 0 3px rgba(0,0,0,0.8);
        }

        .node-stage {
            cursor: move;
            filter: drop-shadow(0 4px 8px rgba(0,0,0,0.4));
        }

        .node-tool {
            cursor: pointer;
            filter: drop-shadow(0 2px 4px rgba(0,0,0,0.3));
        }

        .node-stage:hover, .node-tool:hover {
            filter: drop-shadow(0 6px 12px rgba(0,170,210,0.6));
        }

        .link-stage {
            stroke: #00aad2;
            stroke-width: 4;
            stroke-opacity: 0.6;
            marker-end: url(#arrow-stage);
        }

        .link-tool {
            stroke: #94a3b8;
            stroke-width: 2;
            stroke-opacity: 0.4;
            stroke-dasharray: 5,5;
        }

        .link-data {
            stroke: #10b981;
            stroke-width: 2;
            stroke-opacity: 0.5;
        }

        .link:hover {
            stroke-opacity: 1 !important;
            stroke-width: 6 !important;
        }

        .particle {
            fill: #fff;
            opacity: 0.8;
        }

        .tooltip {
            position: absolute;
            background: rgba(0, 0, 0, 0.9);
            color: #fff;
            padding: 12px 16px;
            border-radius: 8px;
            font-size: 13px;
            pointer-events: none;
            z-index: 1000;
            border: 1px solid rgba(0, 170, 210, 0.5);
            display: none;
            max-width: 300px;
        }

        .status-badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 600;
            margin-left: 8px;
        }

        .status-online {
            background: rgba(16, 185, 129, 0.3);
            color: #10b981;
        }

        .status-warning {
            background: rgba(245, 158, 11, 0.3);
            color: #f59e0b;
        }

        .status-offline {
            background: rgba(220, 38, 38, 0.3);
            color: #dc2626;
        }

        .legend-item {
            display: inline-flex;
            align-items: center;
            margin-right: 20px;
            font-size: 12px;
        }

        .legend-icon {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            margin-right: 8px;
        }

        .control-btn {
            background: rgba(0, 170, 210, 0.2);
            border: 1px solid rgba(0, 170, 210, 0.5);
            padding: 8px 16px;
            border-radius: 8px;
            color: #00aad2;
            font-size: 13px;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-right: 8px;
        }

        .control-btn:hover {
            background: rgba(0, 170, 210, 0.4);
            transform: translateY(-2px);
        }
    </style>
</head>
<body>
    <div class="max-w-[1800px] mx-auto">
        <!-- Header -->
        <div class="glass-card mb-6">
            <div class="flex justify-between items-center">
                <div>
                    <h1 class="text-3xl font-bold mb-2">
                        <i class="fas fa-toolbox mr-3" style="color: var(--secondary);"></i>
                        Toolchain Management Dashboard
                    </h1>
                    <p class="text-gray-400">8Îã®Í≥Ñ DevOps CI/CD ÌååÏù¥ÌîÑÎùºÏù∏ Ïã§ÏãúÍ∞Ñ Î™®ÎãàÌÑ∞ÎßÅ Î∞è Ìà¥ Í∞Ñ Îç∞Ïù¥ÌÑ∞ ÌùêÎ¶Ñ ÏãúÍ∞ÅÌôî</p>
                </div>
                <div class="text-right">
                    <div class="text-sm text-gray-400">Last Updated</div>
                    <div class="text-xl font-semibold text-blue-400" id="last-update">2Î∂Ñ Ï†Ñ</div>
                </div>
            </div>
        </div>

        <!-- KPI Cards -->
        <div class="grid grid-cols-4 gap-4 mb-6">
            <div class="glass-card">
                <div class="flex items-center justify-between">
                    <div>
                        <div class="text-gray-400 text-sm mb-1">Ï¥ù Ìà¥ Ïàò</div>
                        <div class="text-3xl font-bold text-blue-400">23</div>
                        <div class="text-green-400 text-xs mt-1">
                            <i class="fas fa-check-circle"></i> 21 Online
                        </div>
                    </div>
                    <i class="fas fa-tools text-5xl text-blue-400 opacity-20"></i>
                </div>
            </div>

            <div class="glass-card">
                <div class="flex items-center justify-between">
                    <div>
                        <div class="text-gray-400 text-sm mb-1">ÌååÏù¥ÌîÑÎùºÏù∏ Îã®Í≥Ñ</div>
                        <div class="text-3xl font-bold text-purple-400">8</div>
                        <div class="text-blue-400 text-xs mt-1">
                            <i class="fas fa-infinity"></i> Continuous Loop
                        </div>
                    </div>
                    <i class="fas fa-project-diagram text-5xl text-purple-400 opacity-20"></i>
                </div>
            </div>

            <div class="glass-card">
                <div class="flex items-center justify-between">
                    <div>
                        <div class="text-gray-400 text-sm mb-1">Îç∞Ïù¥ÌÑ∞ Ï†ÑÏÜ° (24h)</div>
                        <div class="text-3xl font-bold text-green-400">142</div>
                        <div class="text-green-400 text-xs mt-1">
                            <i class="fas fa-arrow-up"></i> +12 vs Ïñ¥Ï†ú
                        </div>
                    </div>
                    <i class="fas fa-exchange-alt text-5xl text-green-400 opacity-20"></i>
                </div>
            </div>

            <div class="glass-card">
                <div class="flex items-center justify-between">
                    <div>
                        <div class="text-gray-400 text-sm mb-1">Í≤ΩÍ≥†/Ïò§Î•ò</div>
                        <div class="text-3xl font-bold text-yellow-400">2</div>
                        <div class="text-yellow-400 text-xs mt-1">
                            <i class="fas fa-exclamation-triangle"></i> sbt, K8s
                        </div>
                    </div>
                    <i class="fas fa-exclamation-circle text-5xl text-yellow-400 opacity-20"></i>
                </div>
            </div>
        </div>

        <!-- Network Visualization -->
        <div class="glass-card mb-6">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-xl font-semibold">
                    <i class="fas fa-network-wired mr-2"></i>
                    DevOps Toolchain Network (Infinity Loop)
                </h2>
                <div>
                    <button class="control-btn" onclick="resetSimulation()">
                        <i class="fas fa-redo"></i> Reset
                    </button>
                    <button class="control-btn" onclick="toggleAnimation()">
                        <i class="fas fa-play"></i> Animation
                    </button>
                    <button class="control-btn" onclick="fitView()">
                        <i class="fas fa-expand"></i> Fit View
                    </button>
                </div>
            </div>

            <div id="network-container"></div>

            <!-- Legend -->
            <div class="mt-4 pt-4 border-t border-gray-700">
                <div class="flex flex-wrap items-center">
                    <div class="legend-item">
                        <div class="legend-icon" style="background: linear-gradient(135deg, #8b5cf6, #6366f1);"></div>
                        <span>DevOps Stage (8)</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-icon" style="background: linear-gradient(135deg, #10b981, #059669);"></div>
                        <span>Tool (23)</span>
                    </div>
                    <div class="legend-item">
                        <div style="width: 30px; height: 4px; background: #00aad2; margin-right: 8px;"></div>
                        <span>Stage Flow</span>
                    </div>
                    <div class="legend-item">
                        <div style="width: 30px; height: 2px; background: #10b981; margin-right: 8px;"></div>
                        <span>Data Transfer</span>
                    </div>
                    <div class="legend-item">
                        <div style="width: 30px; height: 2px; background: #94a3b8; margin-right: 8px; border-top: 2px dashed;"></div>
                        <span>Tool Link</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Tooltip -->
    <div id="tooltip" class="tooltip"></div>

    <script>
        // Data Structure
        const stages = [
            { id: 'PLAN', name: 'PLAN', icon: 'üìã', color: '#8b5cf6', tools: ['Confluence', 'JIRA'] },
            { id: 'CODE', name: 'CODE', icon: 'üíª', color: '#6366f1', tools: ['Git', 'GitHub', 'Bitbucket'] },
            { id: 'BUILD', name: 'BUILD', icon: 'üî®', color: '#3b82f6', tools: ['Maven', 'sbt', 'Gradle'] },
            { id: 'TEST', name: 'TEST', icon: 'üß™', color: '#0ea5e9', tools: ['Selenium', 'JUnit', 'Robot'] },
            { id: 'RELEASE', name: 'RELEASE', icon: 'üöÄ', color: '#06b6d4', tools: ['Jenkins', 'CodeShip'] },
            { id: 'DEPLOY', name: 'DEPLOY', icon: 'üì¶', color: '#14b8a6', tools: ['Docker', 'AWS', 'Kubernetes'] },
            { id: 'OPERATE', name: 'OPERATE', icon: '‚öôÔ∏è', color: '#10b981', tools: ['Chef', 'Ansible'] },
            { id: 'MONITOR', name: 'MONITOR', icon: 'üìä', color: '#059669', tools: ['Nagios', 'Splunk', 'Grafana'] }
        ];

        const toolStatus = {
            'Confluence': { status: 'online', lastSync: '2m ago', rate: '100%' },
            'JIRA': { status: 'online', lastSync: '1m ago', rate: '100%' },
            'Git': { status: 'online', lastSync: '30s ago', rate: '100%' },
            'GitHub': { status: 'online', lastSync: '5m ago', rate: '99.8%' },
            'Bitbucket': { status: 'online', lastSync: '3m ago', rate: '100%' },
            'Maven': { status: 'online', lastSync: '8m ago', rate: '96.3%' },
            'sbt': { status: 'warning', lastSync: '45m ago', rate: '85%', warning: 'High Memory (85%)' },
            'Gradle': { status: 'online', lastSync: '12m ago', rate: '98.1%' },
            'Selenium': { status: 'online', lastSync: '6m ago', rate: '94.2%' },
            'JUnit': { status: 'online', lastSync: '4m ago', rate: '100%' },
            'Robot': { status: 'online', lastSync: '9m ago', rate: '97.5%' },
            'Jenkins': { status: 'online', lastSync: '2m ago', rate: '99.6%' },
            'CodeShip': { status: 'online', lastSync: '7m ago', rate: '98.9%' },
            'Docker': { status: 'online', lastSync: '1m ago', rate: '100%' },
            'AWS': { status: 'online', lastSync: '30s ago', rate: '99.9%' },
            'Kubernetes': { status: 'warning', lastSync: '15m ago', rate: '87%', warning: '3 Pods Pending Restart' },
            'Chef': { status: 'online', lastSync: '20m ago', rate: '100%' },
            'Ansible': { status: 'online', lastSync: '18m ago', rate: '99.2%' },
            'Nagios': { status: 'online', lastSync: '5m ago', rate: '100%' },
            'Splunk': { status: 'online', lastSync: '1m ago', rate: '99.8%' },
            'Grafana': { status: 'online', lastSync: '2m ago', rate: '100%' }
        };

        const dataFlows = [
            { source: 'PLAN', target: 'CODE', label: '47 Requirements', rate: '47/day' },
            { source: 'CODE', target: 'BUILD', label: '124 Commits', rate: '124/day' },
            { source: 'BUILD', target: 'TEST', label: '89 Artifacts', rate: '89/day' },
            { source: 'TEST', target: 'RELEASE', label: '84 Pass (94.2%)', rate: '94.2%' },
            { source: 'RELEASE', target: 'DEPLOY', label: '23 Deployments', rate: '23/week' },
            { source: 'DEPLOY', target: 'OPERATE', label: '15 Updates', rate: '15/week' },
            { source: 'OPERATE', target: 'MONITOR', label: '2.4M Events', rate: '2.4M/day' },
            { source: 'MONITOR', target: 'PLAN', label: '12 Incidents', rate: '12/week' }
        ];

        // Create Nodes
        const nodes = [];
        const links = [];

        // Add Stage Nodes (Infinity Loop positions)
        const centerX = 600;
        const centerY = 400;
        const radiusX = 250;
        const radiusY = 180;

        stages.forEach((stage, i) => {
            const angle = (i / 8) * 2 * Math.PI - Math.PI / 2;
            let x, y;
            
            // Infinity Loop (‚àû) positioning
            if (i < 4) {
                // Left loop
                x = centerX - radiusX + radiusX * Math.cos(angle * 2);
                y = centerY + radiusY * Math.sin(angle * 2);
            } else {
                // Right loop
                x = centerX + radiusX + radiusX * Math.cos((angle + Math.PI) * 2);
                y = centerY + radiusY * Math.sin((angle + Math.PI) * 2);
            }

            nodes.push({
                id: stage.id,
                name: stage.name,
                icon: stage.icon,
                color: stage.color,
                type: 'stage',
                tools: stage.tools,
                x: x,
                y: y,
                fx: x, // Fix initial position
                fy: y
            });
        });

        // Add Tool Nodes (around each stage)
        stages.forEach((stage, stageIdx) => {
            const stageNode = nodes.find(n => n.id === stage.id);
            stage.tools.forEach((tool, toolIdx) => {
                const angleOffset = (toolIdx - (stage.tools.length - 1) / 2) * 0.5;
                const stageAngle = (stageIdx / 8) * 2 * Math.PI - Math.PI / 2;
                const toolAngle = stageAngle + angleOffset;
                const distance = 120;

                let x, y;
                if (stageIdx < 4) {
                    x = stageNode.x + distance * Math.cos(toolAngle * 2);
                    y = stageNode.y + distance * Math.sin(toolAngle * 2);
                } else {
                    x = stageNode.x + distance * Math.cos((toolAngle + Math.PI) * 2);
                    y = stageNode.y + distance * Math.sin((toolAngle + Math.PI) * 2);
                }

                nodes.push({
                    id: tool,
                    name: tool,
                    type: 'tool',
                    stage: stage.id,
                    status: toolStatus[tool],
                    x: x,
                    y: y
                });

                // Link tool to stage
                links.push({
                    source: stage.id,
                    target: tool,
                    type: 'tool-link'
                });
            });
        });

        // Add Stage Flow Links
        dataFlows.forEach(flow => {
            links.push({
                source: flow.source,
                target: flow.target,
                type: 'stage-flow',
                label: flow.label,
                rate: flow.rate
            });
        });

        // Add inter-tool data transfer links (examples)
        const toolDataFlows = [
            { source: 'JIRA', target: 'GitHub', label: 'Issue Sync' },
            { source: 'GitHub', target: 'Jenkins', label: 'Webhook' },
            { source: 'Maven', target: 'Selenium', label: 'Test Artifacts' },
            { source: 'Docker', target: 'Kubernetes', label: 'Container Deploy' },
            { source: 'Grafana', target: 'JIRA', label: 'Alert Creation' }
        ];

        toolDataFlows.forEach(flow => {
            links.push({
                source: flow.source,
                target: flow.target,
                type: 'data-flow',
                label: flow.label
            });
        });

        // D3.js Force Simulation
        const container = d3.select('#network-container');
        const width = container.node().getBoundingClientRect().width;
        const height = 800;

        const svg = container.append('svg')
            .attr('width', width)
            .attr('height', height);

        // Define arrow markers
        svg.append('defs').selectAll('marker')
            .data(['arrow-stage'])
            .enter().append('marker')
            .attr('id', d => d)
            .attr('viewBox', '0 -5 10 10')
            .attr('refX', 50)
            .attr('refY', 0)
            .attr('markerWidth', 6)
            .attr('markerHeight', 6)
            .attr('orient', 'auto')
            .append('path')
            .attr('d', 'M0,-5L10,0L0,5')
            .attr('fill', '#00aad2');

        // Zoom behavior
        const g = svg.append('g');
        const zoom = d3.zoom()
            .scaleExtent([0.3, 3])
            .on('zoom', (event) => {
                g.attr('transform', event.transform);
            });
        svg.call(zoom);

        // Force Simulation
        const simulation = d3.forceSimulation(nodes)
            .force('link', d3.forceLink(links)
                .id(d => d.id)
                .distance(d => d.type === 'tool-link' ? 80 : 150)
                .strength(d => d.type === 'tool-link' ? 0.5 : 0.3))
            .force('charge', d3.forceManyBody().strength(-400))
            .force('center', d3.forceCenter(width / 2, height / 2))
            .force('collision', d3.forceCollide().radius(d => d.type === 'stage' ? 50 : 35))
            .alphaDecay(0.02);

        // Draw Links
        const link = g.append('g')
            .selectAll('line')
            .data(links)
            .enter().append('line')
            .attr('class', d => `link link-${d.type}`)
            .on('mouseover', showLinkTooltip)
            .on('mouseout', hideTooltip);

        // Draw Nodes
        const node = g.append('g')
            .selectAll('g')
            .data(nodes)
            .enter().append('g')
            .attr('class', d => d.type === 'stage' ? 'node-stage' : 'node-tool')
            .call(d3.drag()
                .on('start', dragStarted)
                .on('drag', dragged)
                .on('end', dragEnded))
            .on('click', nodeClicked)
            .on('mouseover', showNodeTooltip)
            .on('mouseout', hideTooltip);

        // Stage Nodes
        node.filter(d => d.type === 'stage')
            .append('circle')
            .attr('r', 40)
            .attr('fill', d => d.color)
            .attr('stroke', '#fff')
            .attr('stroke-width', 3);

        node.filter(d => d.type === 'stage')
            .append('text')
            .attr('class', 'node-label')
            .attr('dy', -45)
            .style('font-size', '13px')
            .text(d => d.name);

        node.filter(d => d.type === 'stage')
            .append('text')
            .attr('dy', 8)
            .style('font-size', '28px')
            .style('text-anchor', 'middle')
            .text(d => d.icon);

        // Tool Nodes
        node.filter(d => d.type === 'tool')
            .append('circle')
            .attr('r', 25)
            .attr('fill', d => {
                if (d.status.status === 'warning') return '#f59e0b';
                if (d.status.status === 'offline') return '#dc2626';
                return '#10b981';
            })
            .attr('stroke', '#fff')
            .attr('stroke-width', 2);

        node.filter(d => d.type === 'tool')
            .append('text')
            .attr('class', 'node-label')
            .attr('dy', 35)
            .style('font-size', '10px')
            .text(d => d.name);

        // Tooltip
        const tooltip = d3.select('#tooltip');

        function showNodeTooltip(event, d) {
            if (d.type === 'stage') {
                tooltip.html(`
                    <strong>${d.icon} ${d.name}</strong><br>
                    <div class="mt-2">
                        <div class="text-xs text-gray-400">Connected Tools (${d.tools.length})</div>
                        ${d.tools.map(t => `
                            <div class="mt-1">
                                <span class="status-badge status-${toolStatus[t].status}">
                                    ${t}
                                </span>
                            </div>
                        `).join('')}
                    </div>
                `);
            } else {
                const status = d.status;
                tooltip.html(`
                    <strong>${d.name}</strong>
                    <span class="status-badge status-${status.status}">${status.status.toUpperCase()}</span><br>
                    <div class="mt-2 text-xs">
                        <div><i class="fas fa-clock"></i> Last Sync: ${status.lastSync}</div>
                        <div><i class="fas fa-chart-line"></i> Success Rate: ${status.rate}</div>
                        ${status.warning ? `<div class="text-yellow-400 mt-1"><i class="fas fa-exclamation-triangle"></i> ${status.warning}</div>` : ''}
                    </div>
                `);
            }
            tooltip.style('display', 'block')
                .style('left', (event.pageX + 15) + 'px')
                .style('top', (event.pageY - 10) + 'px');
        }

        function showLinkTooltip(event, d) {
            if (d.type === 'stage-flow') {
                tooltip.html(`
                    <strong>Data Flow</strong><br>
                    <div class="mt-1 text-xs">
                        <div><i class="fas fa-arrow-right"></i> ${d.label}</div>
                        <div><i class="fas fa-tachometer-alt"></i> Rate: ${d.rate}</div>
                    </div>
                `);
            } else if (d.type === 'data-flow') {
                tooltip.html(`
                    <strong>Tool Data Transfer</strong><br>
                    <div class="mt-1 text-xs">
                        <div><i class="fas fa-exchange-alt"></i> ${d.label}</div>
                    </div>
                `);
            } else {
                tooltip.html(`
                    <strong>Tool Connection</strong><br>
                    <div class="text-xs text-gray-400">Stage ‚Üî Tool Link</div>
                `);
            }
            tooltip.style('display', 'block')
                .style('left', (event.pageX + 15) + 'px')
                .style('top', (event.pageY - 10) + 'px');
        }

        function hideTooltip() {
            tooltip.style('display', 'none');
        }

        function nodeClicked(event, d) {
            // Highlight connected links
            link.style('stroke-opacity', l => {
                return l.source.id === d.id || l.target.id === d.id ? 1 : 0.1;
            });

            // Reset after 2 seconds
            setTimeout(() => {
                link.style('stroke-opacity', null);
            }, 2000);
        }

        // Drag functions
        function dragStarted(event, d) {
            if (!event.active) simulation.alphaTarget(0.3).restart();
            d.fx = d.x;
            d.fy = d.y;
        }

        function dragged(event, d) {
            d.fx = event.x;
            d.fy = event.y;
        }

        function dragEnded(event, d) {
            if (!event.active) simulation.alphaTarget(0);
            // Keep node fixed after drag
            // d.fx = null;
            // d.fy = null;
        }

        // Simulation tick
        simulation.on('tick', () => {
            link
                .attr('x1', d => d.source.x)
                .attr('y1', d => d.source.y)
                .attr('x2', d => d.target.x)
                .attr('y2', d => d.target.y);

            node.attr('transform', d => `translate(${d.x},${d.y})`);
        });

        // Control Functions
        function resetSimulation() {
            // Unfix all nodes
            nodes.forEach(n => {
                n.fx = null;
                n.fy = null;
            });
            simulation.alpha(1).restart();
        }

        let animationEnabled = false;
        function toggleAnimation() {
            animationEnabled = !animationEnabled;
            if (animationEnabled) {
                startParticleAnimation();
            } else {
                stopParticleAnimation();
            }
        }

        let particleInterval;
        function startParticleAnimation() {
            const stageFlowLinks = links.filter(l => l.type === 'stage-flow');
            
            particleInterval = setInterval(() => {
                stageFlowLinks.forEach(link => {
                    const particle = g.append('circle')
                        .attr('class', 'particle')
                        .attr('r', 4)
                        .attr('cx', link.source.x)
                        .attr('cy', link.source.y);

                    particle.transition()
                        .duration(2000)
                        .attr('cx', link.target.x)
                        .attr('cy', link.target.y)
                        .remove();
                });
            }, 500);
        }

        function stopParticleAnimation() {
            if (particleInterval) {
                clearInterval(particleInterval);
            }
            g.selectAll('.particle').remove();
        }

        function fitView() {
            const bounds = g.node().getBBox();
            const fullWidth = width;
            const fullHeight = height;
            const midX = bounds.x + bounds.width / 2;
            const midY = bounds.y + bounds.height / 2;
            
            const scale = 0.8 / Math.max(bounds.width / fullWidth, bounds.height / fullHeight);
            const translate = [fullWidth / 2 - scale * midX, fullHeight / 2 - scale * midY];

            svg.transition().duration(750).call(
                zoom.transform,
                d3.zoomIdentity.translate(translate[0], translate[1]).scale(scale)
            );
        }

        // Auto-update timestamp
        setInterval(() => {
            const now = new Date();
            const minutes = Math.floor(Math.random() * 5) + 1;
            document.getElementById('last-update').textContent = `${minutes}Î∂Ñ Ï†Ñ`;
        }, 60000);
    </script>
</body>
</html>
