<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FleetFlag - End-to-End ê¸°ëŠ¥ ì œì–´ í˜„í™©</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        :root {
            --primary: #002c5f;
            --secondary: #00aad2;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
            color: #e2e8f0;
        }

        .glass-card {
            background: rgba(30, 41, 59, 0.7);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(148, 163, 184, 0.1);
            border-radius: 16px;
            transition: all 0.3s ease;
        }

        .tab-button {
            padding: 12px 24px;
            border-radius: 8px;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .tab-button.active {
            background: var(--secondary);
            color: white;
            border-color: var(--secondary);
        }

        .tab-button:not(.active) {
            color: #94a3b8;
        }

        .tab-button:not(.active):hover {
            background: rgba(0, 170, 210, 0.1);
            color: var(--secondary);
        }

        .feature-card {
            background: rgba(30, 41, 59, 0.5);
            border: 1px solid rgba(148, 163, 184, 0.2);
            border-radius: 12px;
            padding: 16px;
            transition: all 0.3s ease;
        }

        .feature-card:hover {
            border-color: var(--secondary);
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0, 170, 210, 0.3);
        }

        .status-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 600;
        }

        .status-active { background: rgba(16, 185, 129, 0.2); color: #6ee7b7; }
        .status-testing { background: rgba(245, 158, 11, 0.2); color: #fcd34d; }
        .status-disabled { background: rgba(148, 163, 184, 0.2); color: #cbd5e1; }
        .status-rollback { background: rgba(220, 38, 38, 0.2); color: #fca5a5; }

        .flow-node {
            background: rgba(30, 41, 59, 0.8);
            border: 2px solid rgba(148, 163, 184, 0.3);
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            transition: all 0.3s ease;
            position: relative;
        }

        .flow-node.active {
            border-color: #10b981;
            box-shadow: 0 0 20px rgba(16, 185, 129, 0.5);
            animation: pulse-glow 2s infinite;
        }

        @keyframes pulse-glow {
            0%, 100% { box-shadow: 0 0 20px rgba(16, 185, 129, 0.5); }
            50% { box-shadow: 0 0 30px rgba(16, 185, 129, 0.8); }
        }

        .flow-arrow {
            width: 60px;
            height: 2px;
            background: #475569;
            position: relative;
            margin: 0 auto;
        }

        .flow-arrow::after {
            content: 'â†’';
            position: absolute;
            right: -10px;
            top: -10px;
            font-size: 20px;
            color: #475569;
        }

        .flow-arrow.active {
            background: #10b981;
            animation: flow-animation 1.5s infinite;
        }

        .flow-arrow.active::after {
            color: #10b981;
        }

        @keyframes flow-animation {
            0% { opacity: 0.5; transform: scaleX(0.8); }
            50% { opacity: 1; transform: scaleX(1.2); }
            100% { opacity: 0.5; transform: scaleX(0.8); }
        }

        .log-entry {
            animation: slideIn 0.3s ease-out;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 0.875rem;
            margin-bottom: 6px;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateX(-20px); }
            to { opacity: 1; transform: translateX(0); }
        }

        .log-info { background: rgba(59, 130, 246, 0.1); border-left: 3px solid #3b82f6; }
        .log-success { background: rgba(16, 185, 129, 0.1); border-left: 3px solid #10b981; }
        .log-warning { background: rgba(245, 158, 11, 0.1); border-left: 3px solid #f59e0b; }
        .log-error { background: rgba(220, 38, 38, 0.1); border-left: 3px solid #dc2626; }

        .metric-card {
            background: rgba(30, 41, 59, 0.5);
            border-radius: 8px;
            padding: 16px;
            text-align: center;
        }

        .metric-value {
            font-size: 2rem;
            font-weight: bold;
            background: linear-gradient(135deg, var(--secondary) 0%, #3b82f6 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .progress-bar-container {
            width: 100%;
            height: 8px;
            background: rgba(148, 163, 184, 0.2);
            border-radius: 4px;
            overflow: hidden;
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #10b981 0%, #00aad2 100%);
            transition: width 0.5s ease;
        }
    </style>
</head>
<body class="p-6">
    <!-- Header -->
    <div class="max-w-7xl mx-auto mb-6">
        <div class="glass-card p-6">
            <div class="flex items-center justify-between">
                <div class="flex items-center gap-4">
                    <div class="w-12 h-12 bg-gradient-to-br from-blue-500 to-cyan-400 rounded-lg flex items-center justify-center">
                        <i class="fas fa-network-wired text-white text-xl"></i>
                    </div>
                    <div>
                        <h1 class="text-3xl font-bold text-white">End-to-End ê¸°ëŠ¥ ì œì–´ í˜„í™©</h1>
                        <p class="text-gray-400">ì „ì²´ Featureì˜ ì‹¤ì‹œê°„ ì œì–´ ìƒíƒœ ëª¨ë‹ˆí„°ë§ ë° ì‹œë®¬ë ˆì´ì…˜</p>
                    </div>
                </div>
                <div class="text-right">
                    <div class="text-sm text-gray-400">System Status</div>
                    <div class="text-2xl font-bold text-green-400">
                        <i class="fas fa-check-circle mr-2"></i>ì •ìƒ
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Tab Navigation -->
    <div class="max-w-7xl mx-auto mb-6">
        <div class="glass-card p-2">
            <div class="flex gap-2">
                <button class="tab-button active" data-tab="current">
                    <i class="fas fa-eye mr-2"></i>í˜„ì¬ í˜„í™©
                </button>
                <button class="tab-button" data-tab="simulation">
                    <i class="fas fa-play-circle mr-2"></i>ì‹œë®¬ë ˆì´ì…˜
                </button>
            </div>
        </div>
    </div>

    <!-- Tab Content -->
    <div class="max-w-7xl mx-auto">
        
        <!-- Current Status Tab -->
        <div id="tab-current" class="tab-content">
            
            <!-- Real-time Metrics -->
            <div class="glass-card p-6 mb-6">
                <h2 class="text-xl font-bold text-white mb-4">
                    <i class="fas fa-tachometer-alt mr-2 text-blue-400"></i>
                    ì‹¤ì‹œê°„ ì‹œìŠ¤í…œ ë©”íŠ¸ë¦­
                </h2>
                <div class="grid grid-cols-4 gap-4">
                    <div class="metric-card">
                        <div class="text-gray-400 text-sm mb-2">í™œì„± Feature</div>
                        <div class="metric-value" id="active-features">23</div>
                        <div class="text-gray-500 text-xs mt-1">/ 35ê°œ ì „ì²´</div>
                    </div>
                    <div class="metric-card">
                        <div class="text-gray-400 text-sm mb-2">ì˜¨ë¼ì¸ ì°¨ëŸ‰</div>
                        <div class="metric-value" id="online-vehicles">123,847</div>
                        <div class="text-gray-500 text-xs mt-1">/ 125,000ëŒ€</div>
                    </div>
                    <div class="metric-card">
                        <div class="text-gray-400 text-sm mb-2">í‰ê°€ ì§€ì—°ì‹œê°„</div>
                        <div class="metric-value text-green-400" id="eval-latency">2.1ms</div>
                        <div class="text-gray-500 text-xs mt-1">P95 ëª©í‘œ: <50ms</div>
                    </div>
                    <div class="metric-card">
                        <div class="text-gray-400 text-sm mb-2">ì˜¤ëŠ˜ì˜ ë°°í¬</div>
                        <div class="metric-value text-blue-400" id="today-deployments">8</div>
                        <div class="text-gray-500 text-xs mt-1">ì„±ê³µ 7 / ë¡¤ë°± 1</div>
                    </div>
                </div>
            </div>

            <!-- Active Features List -->
            <div class="glass-card p-6 mb-6">
                <div class="flex items-center justify-between mb-4">
                    <h2 class="text-xl font-bold text-white">
                        <i class="fas fa-list mr-2 text-green-400"></i>
                        í˜„ì¬ í™œì„± Feature ëª©ë¡
                    </h2>
                    <div class="flex gap-2">
                        <span class="status-badge status-active">
                            <i class="fas fa-circle mr-1"></i>Active (23)
                        </span>
                        <span class="status-badge status-testing">
                            <i class="fas fa-circle mr-1"></i>Testing (8)
                        </span>
                        <span class="status-badge status-disabled">
                            <i class="fas fa-circle mr-1"></i>Disabled (4)
                        </span>
                    </div>
                </div>

                <div class="grid grid-cols-2 gap-4" id="features-list">
                    <!-- Feature cards will be dynamically inserted -->
                </div>
            </div>

            <!-- E2E Flow Visualization -->
            <div class="glass-card p-6">
                <h2 class="text-xl font-bold text-white mb-6">
                    <i class="fas fa-project-diagram mr-2 text-purple-400"></i>
                    End-to-End ì œì–´ íë¦„ (ì‹¤ì‹œê°„)
                </h2>
                
                <div class="grid grid-cols-7 gap-4 items-center">
                    <!-- Node 1: Admin Console -->
                    <div class="flow-node" id="flow-admin">
                        <div class="text-3xl mb-2">ğŸ‘¤</div>
                        <div class="font-bold text-white">Admin Console</div>
                        <div class="text-xs text-gray-400 mt-1">Feature ì„¤ì •</div>
                        <div class="text-xs text-green-400 mt-2" id="admin-status">ëŒ€ê¸° ì¤‘</div>
                    </div>

                    <div class="flow-arrow" id="arrow-1"></div>

                    <!-- Node 2: FleetFlag API -->
                    <div class="flow-node" id="flow-api">
                        <div class="text-3xl mb-2">ğŸ”§</div>
                        <div class="font-bold text-white">FleetFlag API</div>
                        <div class="text-xs text-gray-400 mt-1">ì„¤ì • ì €ì¥</div>
                        <div class="text-xs text-blue-400 mt-2" id="api-status">ì¤€ë¹„</div>
                    </div>

                    <div class="flow-arrow" id="arrow-2"></div>

                    <!-- Node 3: Flipt Engine -->
                    <div class="flow-node" id="flow-flipt">
                        <div class="text-3xl mb-2">âš™ï¸</div>
                        <div class="font-bold text-white">Flipt Engine</div>
                        <div class="text-xs text-gray-400 mt-1">ê·œì¹™ ì²˜ë¦¬</div>
                        <div class="text-xs text-purple-400 mt-2" id="flipt-status">ëŒ€ê¸°</div>
                    </div>

                    <div class="flow-arrow" id="arrow-3"></div>

                    <!-- Node 4: PostgreSQL -->
                    <div class="flow-node" id="flow-db">
                        <div class="text-3xl mb-2">ğŸ—„ï¸</div>
                        <div class="font-bold text-white">PostgreSQL</div>
                        <div class="text-xs text-gray-400 mt-1">ë°ì´í„° ì €ì¥</div>
                        <div class="text-xs text-yellow-400 mt-2" id="db-status">ë™ê¸°í™”</div>
                    </div>

                    <div class="flow-arrow" id="arrow-4"></div>

                    <!-- Node 5: Redis Cache -->
                    <div class="flow-node" id="flow-redis">
                        <div class="text-3xl mb-2">âš¡</div>
                        <div class="font-bold text-white">Redis Cache</div>
                        <div class="text-xs text-gray-400 mt-1">ìºì‹œ ì—…ë°ì´íŠ¸</div>
                        <div class="text-xs text-orange-400 mt-2" id="redis-status">ê°±ì‹  ì¤‘</div>
                    </div>

                    <div class="flow-arrow" id="arrow-5"></div>

                    <!-- Node 6: Vehicle Agent -->
                    <div class="flow-node" id="flow-vehicle">
                        <div class="text-3xl mb-2">ğŸš—</div>
                        <div class="font-bold text-white">Vehicle Agent</div>
                        <div class="text-xs text-gray-400 mt-1">Feature í‰ê°€</div>
                        <div class="text-xs text-green-400 mt-2" id="vehicle-status">ì‹¤í–‰ ì¤‘</div>
                    </div>

                    <div class="flow-arrow" id="arrow-6"></div>

                    <!-- Node 7: ClickHouse -->
                    <div class="flow-node" id="flow-analytics">
                        <div class="text-3xl mb-2">ğŸ“Š</div>
                        <div class="font-bold text-white">ClickHouse</div>
                        <div class="text-xs text-gray-400 mt-1">ë¡œê·¸ ìˆ˜ì§‘</div>
                        <div class="text-xs text-cyan-400 mt-2" id="analytics-status">ê¸°ë¡ ì¤‘</div>
                    </div>
                </div>

                <!-- Flow Statistics -->
                <div class="mt-6 grid grid-cols-3 gap-4">
                    <div class="bg-gray-800/50 rounded-lg p-4">
                        <div class="text-sm text-gray-400 mb-1">í‰ê·  E2E ì²˜ë¦¬ ì‹œê°„</div>
                        <div class="text-2xl font-bold text-green-400">47ms</div>
                    </div>
                    <div class="bg-gray-800/50 rounded-lg p-4">
                        <div class="text-sm text-gray-400 mb-1">ì´ˆë‹¹ ì²˜ë¦¬ ìš”ì²­</div>
                        <div class="text-2xl font-bold text-blue-400">2,847</div>
                    </div>
                    <div class="bg-gray-800/50 rounded-lg p-4">
                        <div class="text-sm text-gray-400 mb-1">ì—ëŸ¬ìœ¨</div>
                        <div class="text-2xl font-bold text-yellow-400">0.08%</div>
                    </div>
                </div>
            </div>

        </div>

        <!-- Simulation Tab -->
        <div id="tab-simulation" class="tab-content hidden">
            
            <!-- Scenario Selection -->
            <div class="glass-card p-6 mb-6">
                <h2 class="text-xl font-bold text-white mb-4">
                    <i class="fas fa-flask mr-2 text-yellow-400"></i>
                    ì‹œë®¬ë ˆì´ì…˜ ì‹œë‚˜ë¦¬ì˜¤ ì„ íƒ
                </h2>
                <div class="grid grid-cols-3 gap-4">
                    <button class="scenario-btn p-4 bg-gray-800/50 rounded-lg border-2 border-transparent hover:border-blue-500 transition-all" data-scenario="deploy">
                        <div class="text-3xl mb-2">ğŸš€</div>
                        <div class="font-bold text-white mb-2">ì‹ ê·œ Feature ë°°í¬</div>
                        <div class="text-sm text-gray-400">Admin â†’ Vehicle ì „ì²´ íë¦„</div>
                    </button>
                    <button class="scenario-btn p-4 bg-gray-800/50 rounded-lg border-2 border-transparent hover:border-red-500 transition-all" data-scenario="killswitch">
                        <div class="text-3xl mb-2">ğŸš¨</div>
                        <div class="font-bold text-white mb-2">ê¸´ê¸‰ Kill Switch</div>
                        <div class="text-sm text-gray-400">3ì‹œê°„ ë‚´ 125,000ëŒ€ ë¹„í™œì„±í™”</div>
                    </button>
                    <button class="scenario-btn p-4 bg-gray-800/50 rounded-lg border-2 border-transparent hover:border-green-500 transition-all" data-scenario="abtest">
                        <div class="text-3xl mb-2">ğŸ§ª</div>
                        <div class="font-bold text-white mb-2">A/B í…ŒìŠ¤íŠ¸</div>
                        <div class="text-sm text-gray-400">50% íŠ¸ë˜í”½ ë¶„ì‚° í…ŒìŠ¤íŠ¸</div>
                    </button>
                </div>
            </div>

            <!-- Simulation Progress -->
            <div class="glass-card p-6 mb-6" id="simulation-progress" style="display: none;">
                <h2 class="text-xl font-bold text-white mb-4">
                    <i class="fas fa-spinner fa-spin mr-2 text-blue-400"></i>
                    ì‹œë®¬ë ˆì´ì…˜ ì§„í–‰ ì¤‘
                </h2>
                
                <div class="mb-4">
                    <div class="flex justify-between mb-2">
                        <span class="text-gray-400" id="sim-step-name">ì´ˆê¸°í™” ì¤‘...</span>
                        <span class="text-blue-400" id="sim-progress-text">0%</span>
                    </div>
                    <div class="progress-bar-container">
                        <div class="progress-bar" id="sim-progress-bar" style="width: 0%"></div>
                    </div>
                </div>

                <div class="grid grid-cols-7 gap-4 items-center mb-6">
                    <div class="flow-node" id="sim-admin">
                        <div class="text-2xl">ğŸ‘¤</div>
                        <div class="text-xs mt-1">Admin</div>
                    </div>
                    <div class="flow-arrow" id="sim-arrow-1"></div>
                    <div class="flow-node" id="sim-api">
                        <div class="text-2xl">ğŸ”§</div>
                        <div class="text-xs mt-1">API</div>
                    </div>
                    <div class="flow-arrow" id="sim-arrow-2"></div>
                    <div class="flow-node" id="sim-flipt">
                        <div class="text-2xl">âš™ï¸</div>
                        <div class="text-xs mt-1">Flipt</div>
                    </div>
                    <div class="flow-arrow" id="sim-arrow-3"></div>
                    <div class="flow-node" id="sim-db">
                        <div class="text-2xl">ğŸ—„ï¸</div>
                        <div class="text-xs mt-1">DB</div>
                    </div>
                    <div class="flow-arrow" id="sim-arrow-4"></div>
                    <div class="flow-node" id="sim-redis">
                        <div class="text-2xl">âš¡</div>
                        <div class="text-xs mt-1">Redis</div>
                    </div>
                    <div class="flow-arrow" id="sim-arrow-5"></div>
                    <div class="flow-node" id="sim-vehicle">
                        <div class="text-2xl">ğŸš—</div>
                        <div class="text-xs mt-1">Vehicle</div>
                    </div>
                    <div class="flow-arrow" id="sim-arrow-6"></div>
                    <div class="flow-node" id="sim-analytics">
                        <div class="text-2xl">ğŸ“Š</div>
                        <div class="text-xs mt-1">Analytics</div>
                    </div>
                </div>

                <!-- Live Logs -->
                <div class="bg-gray-900/50 rounded-lg p-4 max-h-64 overflow-y-auto" id="simulation-logs">
                    <div class="text-sm text-gray-400 mb-2">ì‹¤ì‹œê°„ ë¡œê·¸</div>
                    <!-- Logs will be dynamically inserted -->
                </div>
            </div>

            <!-- Simulation Results -->
            <div class="glass-card p-6" id="simulation-results" style="display: none;">
                <h2 class="text-xl font-bold text-white mb-4">
                    <i class="fas fa-check-circle mr-2 text-green-400"></i>
                    ì‹œë®¬ë ˆì´ì…˜ ì™„ë£Œ
                </h2>
                <div class="grid grid-cols-4 gap-4" id="results-metrics">
                    <!-- Results will be dynamically inserted -->
                </div>
                <div class="mt-4 text-center">
                    <button id="reset-simulation" class="px-6 py-3 bg-blue-600 hover:bg-blue-700 rounded-lg font-bold text-white">
                        <i class="fas fa-redo mr-2"></i>ë‹¤ì‹œ ì‹œë®¬ë ˆì´ì…˜
                    </button>
                </div>
            </div>

        </div>

    </div>

    <script>
        // Sample Features Data
        const features = [
            { id: 1, name: 'ADAS Level 3', status: 'active', rollout: 85, vehicles: 106250, p95: 42, asil: 'D' },
            { id: 2, name: 'HDA2 ê³ ì†ë„ë¡œ ì£¼í–‰', status: 'testing', rollout: 30, vehicles: 37500, p95: 48, asil: 'C' },
            { id: 3, name: 'ì°¨ì„ ë³€ê²½ ë³´ì¡° (LCA)', status: 'disabled', rollout: 0, vehicles: 0, p95: 0, asil: 'B' },
            { id: 4, name: 'ë°°í„°ë¦¬ ì¶©ì „ ìµœì í™”', status: 'active', rollout: 100, vehicles: 125000, p95: 38, asil: 'A' },
            { id: 5, name: 'AI ì£¼ì°¨ ë³´ì¡°', status: 'active', rollout: 65, vehicles: 81250, p95: 45, asil: 'B' },
            { id: 6, name: 'ìŒì„± ì¸ì‹ ê°œì„ ', status: 'active', rollout: 100, vehicles: 125000, p95: 35, asil: null },
            { id: 7, name: 'ì—ë„ˆì§€ íšŒìƒ ì œì–´', status: 'testing', rollout: 15, vehicles: 18750, p95: 52, asil: 'C' },
            { id: 8, name: 'OTA ì—…ë°ì´íŠ¸ v2.4', status: 'active', rollout: 92, vehicles: 115000, p95: 40, asil: null }
        ];

        // Render Features List
        function renderFeatures() {
            const container = document.getElementById('features-list');
            container.innerHTML = features.map(f => `
                <div class="feature-card">
                    <div class="flex items-start justify-between mb-3">
                        <div class="flex-1">
                            <h3 class="font-bold text-white mb-1">${f.name}</h3>
                            <div class="flex gap-2 mt-2">
                                <span class="status-badge status-${f.status}">
                                    ${f.status === 'active' ? 'Active' : f.status === 'testing' ? 'Testing' : 'Disabled'}
                                </span>
                                ${f.asil ? `<span class="status-badge" style="background: rgba(139, 92, 246, 0.2); color: #c4b5fd;">ASIL-${f.asil}</span>` : ''}
                            </div>
                        </div>
                        <div class="text-2xl">${f.status === 'active' ? 'ğŸŸ¢' : f.status === 'testing' ? 'ğŸŸ¡' : 'âšª'}</div>
                    </div>
                    <div class="space-y-2">
                        <div class="flex justify-between text-sm">
                            <span class="text-gray-400">Rollout</span>
                            <span class="text-white font-semibold">${f.rollout}%</span>
                        </div>
                        <div class="progress-bar-container">
                            <div class="progress-bar" style="width: ${f.rollout}%"></div>
                        </div>
                        <div class="flex justify-between text-xs text-gray-500">
                            <span>${f.vehicles.toLocaleString()}ëŒ€ í™œì„±</span>
                            ${f.p95 > 0 ? `<span>P95: ${f.p95}ms</span>` : ''}
                        </div>
                    </div>
                </div>
            `).join('');
        }

        // Tab Switching
        document.querySelectorAll('.tab-button').forEach(btn => {
            btn.addEventListener('click', () => {
                const tab = btn.dataset.tab;
                
                // Update buttons
                document.querySelectorAll('.tab-button').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                
                // Update content
                document.querySelectorAll('.tab-content').forEach(c => c.classList.add('hidden'));
                document.getElementById(`tab-${tab}`).classList.remove('hidden');
            });
        });

        // Real-time Flow Animation (Current Status)
        let flowInterval;
        function startFlowAnimation() {
            const nodes = ['admin', 'api', 'flipt', 'db', 'redis', 'vehicle', 'analytics'];
            const arrows = ['arrow-1', 'arrow-2', 'arrow-3', 'arrow-4', 'arrow-5', 'arrow-6'];
            let currentIndex = 0;

            flowInterval = setInterval(() => {
                // Remove all active classes
                nodes.forEach(n => document.getElementById(`flow-${n}`)?.classList.remove('active'));
                arrows.forEach(a => document.getElementById(a)?.classList.remove('active'));

                // Add active to current
                if (currentIndex < nodes.length) {
                    document.getElementById(`flow-${nodes[currentIndex]}`)?.classList.add('active');
                }
                if (currentIndex < arrows.length) {
                    document.getElementById(arrows[currentIndex])?.classList.add('active');
                }

                currentIndex++;
                if (currentIndex >= nodes.length + arrows.length) {
                    currentIndex = 0;
                }
            }, 800);
        }

        // Simulation
        const scenarios = {
            deploy: {
                name: 'ì‹ ê·œ Feature ë°°í¬',
                steps: [
                    { node: 'admin', arrow: 'arrow-1', log: 'Admin Consoleì—ì„œ Feature "ADAS Level 3" í™œì„±í™” ìš”ì²­', type: 'info', delay: 500 },
                    { node: 'api', arrow: 'arrow-2', log: 'FleetFlag APIê°€ ìš”ì²­ ìˆ˜ì‹  (47ms)', type: 'success', delay: 800 },
                    { node: 'flipt', arrow: 'arrow-3', log: 'Flipt Engineì—ì„œ ê·œì¹™ ì²˜ë¦¬ ì‹œì‘', type: 'info', delay: 1000 },
                    { node: 'db', arrow: 'arrow-4', log: 'PostgreSQLì— Feature ì„¤ì • ì €ì¥ ì™„ë£Œ', type: 'success', delay: 1200 },
                    { node: 'redis', arrow: 'arrow-5', log: 'Redis Cache ê°±ì‹  (125,000ëŒ€ ë™ê¸°í™”)', type: 'info', delay: 1500 },
                    { node: 'vehicle', arrow: 'arrow-6', log: 'ì°¨ëŸ‰ Agentê°€ ìƒˆ ì„¤ì • ìˆ˜ì‹  ë° í‰ê°€ (2.1ms)', type: 'success', delay: 2000 },
                    { node: 'analytics', arrow: null, log: 'ClickHouseì— ë°°í¬ ë¡œê·¸ ê¸°ë¡', type: 'success', delay: 2200 }
                ]
            },
            killswitch: {
                name: 'Kill Switch ê¸´ê¸‰ ì°¨ë‹¨',
                steps: [
                    { node: 'admin', arrow: 'arrow-1', log: 'ğŸš¨ ê¸´ê¸‰! LCA ê²°í•¨ ê°ì§€ - Kill Switch ë°œë™', type: 'error', delay: 300 },
                    { node: 'api', arrow: 'arrow-2', log: 'FleetFlag API ê¸´ê¸‰ ëª¨ë“œ í™œì„±í™”', type: 'warning', delay: 500 },
                    { node: 'flipt', arrow: 'arrow-3', log: 'Flipt Engineì—ì„œ ê¸´ê¸‰ ê·œì¹™ ì ìš©', type: 'warning', delay: 700 },
                    { node: 'db', arrow: 'arrow-4', log: 'PostgreSQLì— Kill Switch ì´ë²¤íŠ¸ ê¸°ë¡', type: 'error', delay: 900 },
                    { node: 'redis', arrow: 'arrow-5', log: 'Redis ìµœìš°ì„  ìˆœìœ„ ìºì‹œ í‘¸ì‹œ (12,500 msg/s)', type: 'warning', delay: 1200 },
                    { node: 'vehicle', arrow: 'arrow-6', log: '125,000ëŒ€ ì°¨ëŸ‰ì— ë¹„í™œì„±í™” ëª…ë ¹ ì „íŒŒ ì¤‘...', type: 'warning', delay: 1800 },
                    { node: 'analytics', arrow: null, log: 'ClickHouseì— ê¸´ê¸‰ ì¡°ì¹˜ ë¡œê·¸ ìˆ˜ì§‘', type: 'error', delay: 2000 }
                ]
            },
            abtest: {
                name: 'A/B í…ŒìŠ¤íŠ¸ ì‹œì‘',
                steps: [
                    { node: 'admin', arrow: 'arrow-1', log: 'A/B Test ì„¤ì •: ë°°í„°ë¦¬ ì¶©ì „ ì•Œê³ ë¦¬ì¦˜ (50% vs 50%)', type: 'info', delay: 500 },
                    { node: 'api', arrow: 'arrow-2', log: 'FleetFlag APIì—ì„œ Variant ë¶„ë°° ë¡œì§ ìƒì„±', type: 'success', delay: 800 },
                    { node: 'flipt', arrow: 'arrow-3', log: 'Flipt Engineì—ì„œ íŠ¸ë˜í”½ ë¶„ì‚° ê·œì¹™ ì ìš©', type: 'info', delay: 1000 },
                    { node: 'db', arrow: 'arrow-4', log: 'PostgreSQLì— A/B Test ë©”íƒ€ë°ì´í„° ì €ì¥', type: 'success', delay: 1200 },
                    { node: 'redis', arrow: 'arrow-5', log: 'Redisì— Variant í• ë‹¹í‘œ ìºì‹±', type: 'info', delay: 1400 },
                    { node: 'vehicle', arrow: 'arrow-6', log: '62,500ëŒ€ â†’ Variant A, 62,500ëŒ€ â†’ Variant B', type: 'success', delay: 2000 },
                    { node: 'analytics', arrow: null, log: 'ClickHouseì—ì„œ ì‹¤ì‹œê°„ ê²°ê³¼ ë¶„ì„ ì‹œì‘', type: 'success', delay: 2200 }
                ]
            }
        };

        let currentSimulation = null;
        let simStepIndex = 0;

        document.querySelectorAll('.scenario-btn').forEach(btn => {
            btn.addEventListener('click', async () => {
                const scenario = btn.dataset.scenario;
                currentSimulation = scenarios[scenario];
                simStepIndex = 0;

                // Show progress section
                document.getElementById('simulation-progress').style.display = 'block';
                document.getElementById('simulation-results').style.display = 'none';
                document.getElementById('sim-step-name').textContent = currentSimulation.name;
                document.getElementById('simulation-logs').innerHTML = '<div class="text-sm text-gray-400 mb-2">ì‹¤ì‹œê°„ ë¡œê·¸</div>';

                // Reset nodes
                ['admin', 'api', 'flipt', 'db', 'redis', 'vehicle', 'analytics'].forEach(n => {
                    document.getElementById(`sim-${n}`)?.classList.remove('active');
                });
                ['arrow-1', 'arrow-2', 'arrow-3', 'arrow-4', 'arrow-5', 'arrow-6'].forEach(a => {
                    document.getElementById(`sim-${a}`)?.classList.remove('active');
                });

                // Run simulation
                await runSimulation();
            });
        });

        async function runSimulation() {
            const steps = currentSimulation.steps;
            
            for (let i = 0; i < steps.length; i++) {
                const step = steps[i];
                const progress = Math.round(((i + 1) / steps.length) * 100);
                
                // Update progress
                document.getElementById('sim-progress-text').textContent = `${progress}%`;
                document.getElementById('sim-progress-bar').style.width = `${progress}%`;
                
                // Activate node
                document.getElementById(`sim-${step.node}`)?.classList.add('active');
                if (step.arrow) {
                    document.getElementById(`sim-${step.arrow}`)?.classList.add('active');
                }
                
                // Add log
                const logDiv = document.createElement('div');
                logDiv.className = `log-entry log-${step.type}`;
                logDiv.innerHTML = `
                    <span class="text-xs text-gray-500">[${new Date().toLocaleTimeString()}]</span>
                    <span class="ml-2">${step.log}</span>
                `;
                document.getElementById('simulation-logs').appendChild(logDiv);
                document.getElementById('simulation-logs').scrollTop = document.getElementById('simulation-logs').scrollHeight;
                
                await new Promise(resolve => setTimeout(resolve, step.delay));
            }

            // Show results
            setTimeout(() => {
                document.getElementById('simulation-progress').style.display = 'none';
                document.getElementById('simulation-results').style.display = 'block';
                
                const resultsMetrics = [
                    { label: 'ì´ ì†Œìš” ì‹œê°„', value: `${(steps.reduce((sum, s) => sum + s.delay, 0) / 1000).toFixed(1)}ì´ˆ`, color: 'blue' },
                    { label: 'ì²˜ë¦¬ëœ ìš”ì²­', value: '125,000ê±´', color: 'green' },
                    { label: 'í‰ê·  ì§€ì—°ì‹œê°„', value: '47ms', color: 'yellow' },
                    { label: 'ì„±ê³µë¥ ', value: '99.97%', color: 'green' }
                ];
                
                document.getElementById('results-metrics').innerHTML = resultsMetrics.map(m => `
                    <div class="metric-card">
                        <div class="text-gray-400 text-sm mb-2">${m.label}</div>
                        <div class="text-2xl font-bold text-${m.color}-400">${m.value}</div>
                    </div>
                `).join('');
            }, 500);
        }

        document.getElementById('reset-simulation')?.addEventListener('click', () => {
            document.getElementById('simulation-results').style.display = 'none';
        });

        // Initialize
        renderFeatures();
        startFlowAnimation();
    </script>
</body>
</html>
