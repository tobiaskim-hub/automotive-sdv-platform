<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FleetFlag - Kill Switch Control Center</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        @keyframes alert-pulse {
            0%, 100% { background-color: #dc2626; }
            50% { background-color: #991b1b; }
        }
        .kill-switch-active {
            animation: alert-pulse 1.5s infinite;
        }
        .two-factor-input {
            width: 50px;
            height: 50px;
            font-size: 24px;
            text-align: center;
        }
        .timeline-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            position: absolute;
            left: -6px;
        }
    </style>
</head>
<body class="bg-gray-100">
    <!-- Header -->
    <header class="bg-red-700 text-white shadow-lg">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <i class="fas fa-power-off text-3xl"></i>
                    <div>
                        <h1 class="text-2xl font-bold">Kill Switch Control Center</h1>
                        <p class="text-sm text-red-200">긴급 기능 차단 시스템 | 3시간 이내 전 차량 적용</p>
                    </div>
                </div>
                <div class="flex items-center space-x-6">
                    <div class="text-right">
                        <div class="text-xs text-red-200">승인자</div>
                        <div class="font-bold">이성룡 부장 (Safety Manager)</div>
                    </div>
                    <div class="text-right">
                        <div class="text-xs text-red-200">현재 시각</div>
                        <div class="font-bold" id="current-time">2026-02-01 14:35:22 KST</div>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <div class="container mx-auto px-6 py-8">
        <!-- Active Kill Switches -->
        <div class="bg-red-100 border-l-4 border-red-600 rounded-lg p-6 mb-8">
            <div class="flex items-center justify-between mb-4">
                <div class="flex items-center space-x-3">
                    <i class="fas fa-exclamation-triangle text-red-600 text-2xl"></i>
                    <h2 class="text-xl font-bold text-red-900">활성 Kill Switch 현황</h2>
                </div>
                <span class="bg-red-600 text-white px-4 py-2 rounded-full font-bold">2개 활성</span>
            </div>
            
            <!-- Active Kill Switch Card 1 -->
            <div class="bg-white rounded-lg shadow-lg p-6 mb-4 border-l-4 border-red-600">
                <div class="flex items-start justify-between mb-4">
                    <div class="flex-1">
                        <div class="flex items-center space-x-3 mb-2">
                            <span class="bg-red-600 text-white px-3 py-1 rounded-full text-sm font-bold kill-switch-active">ACTIVE</span>
                            <span class="bg-purple-600 text-white px-3 py-1 rounded text-sm font-bold">ASIL-D</span>
                        </div>
                        <h3 class="text-xl font-bold text-gray-900 mb-2">FLAG-2024-0523: 자율주행 레벨3 고속도로 모드</h3>
                        <p class="text-gray-600 mb-4">긴급 차단 사유: 고속도로 차선 인식 센서(Mobileye EyeQ5) 펌웨어 결함 발견. 차선 이탈 감지 오류로 인한 안전 위험.</p>
                    </div>
                    <button class="bg-yellow-500 text-white px-4 py-2 rounded hover:bg-yellow-600 ml-4">
                        <i class="fas fa-undo mr-2"></i>복구
                    </button>
                </div>
                
                <div class="grid grid-cols-4 gap-4 mb-4">
                    <div>
                        <div class="text-xs text-gray-500 mb-1">차단 시각</div>
                        <div class="font-bold text-gray-900">2026-01-28 09:15:33</div>
                    </div>
                    <div>
                        <div class="text-xs text-gray-500 mb-1">영향 차량</div>
                        <div class="font-bold text-red-600">12,847대</div>
                    </div>
                    <div>
                        <div class="text-xs text-gray-500 mb-1">승인자</div>
                        <div class="font-bold text-gray-900">김철수 상무 (CTO)</div>
                    </div>
                    <div>
                        <div class="text-xs text-gray-500 mb-1">전파 완료율</div>
                        <div class="font-bold text-green-600">100% (2h 43m)</div>
                    </div>
                </div>

                <div class="bg-gray-50 rounded p-4">
                    <div class="text-sm text-gray-600 mb-2">
                        <i class="fas fa-microchip mr-2"></i><strong>연관 BOM:</strong> ECU-HW-0234 (Mobileye EyeQ5), SW-FW-5621 (v2.3.1)
                    </div>
                    <div class="text-sm text-gray-600">
                        <i class="fas fa-car mr-2"></i><strong>대상 차량:</strong> GN7, G90 (2025-2026 모델), HW BOM Rev. 3.2+
                    </div>
                </div>
            </div>

            <!-- Active Kill Switch Card 2 -->
            <div class="bg-white rounded-lg shadow-lg p-6 border-l-4 border-orange-600">
                <div class="flex items-start justify-between mb-4">
                    <div class="flex-1">
                        <div class="flex items-center space-x-3 mb-2">
                            <span class="bg-orange-600 text-white px-3 py-1 rounded-full text-sm font-bold">SCHEDULED</span>
                            <span class="bg-blue-600 text-white px-3 py-1 rounded text-sm font-bold">ASIL-B</span>
                        </div>
                        <h3 class="text-xl font-bold text-gray-900 mb-2">FLAG-2024-0612: OTA 자동 업데이트 (배터리 관리)</h3>
                        <p class="text-gray-600 mb-4">계획 차단: 겨울철 배터리 성능 저하 이슈로 인해 OTA 업데이트 일시 중단. 차주 수동 업데이트로 전환.</p>
                    </div>
                    <button class="bg-red-600 text-white px-4 py-2 rounded hover:bg-red-700 ml-4">
                        <i class="fas fa-play mr-2"></i>즉시 실행
                    </button>
                </div>
                
                <div class="grid grid-cols-4 gap-4 mb-4">
                    <div>
                        <div class="text-xs text-gray-500 mb-1">예정 시각</div>
                        <div class="font-bold text-gray-900">2026-02-05 02:00:00</div>
                    </div>
                    <div>
                        <div class="text-xs text-gray-500 mb-1">영향 차량</div>
                        <div class="font-bold text-orange-600">45,231대</div>
                    </div>
                    <div>
                        <div class="text-xs text-gray-500 mb-1">승인자</div>
                        <div class="font-bold text-gray-900">박영희 부장 (EV Tech)</div>
                    </div>
                    <div>
                        <div class="text-xs text-gray-500 mb-1">상태</div>
                        <div class="font-bold text-blue-600">대기 중</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Kill Switch Activation Panel -->
        <div class="grid grid-cols-2 gap-8 mb-8">
            <!-- Left: New Kill Switch -->
            <div class="bg-white rounded-lg shadow-lg p-6">
                <div class="flex items-center space-x-3 mb-6 pb-4 border-b">
                    <i class="fas fa-plus-circle text-red-600 text-2xl"></i>
                    <h2 class="text-xl font-bold text-gray-900">새 Kill Switch 발동</h2>
                </div>

                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Feature Flag 선택 *</label>
                        <select class="w-full border border-gray-300 rounded px-3 py-2">
                            <option>-- Feature Flag 선택 --</option>
                            <option>FLAG-2024-0523: 자율주행 레벨3 고속도로 모드</option>
                            <option>FLAG-2024-0611: 스마트 크루즈 컨트롤 (딥러닝)</option>
                            <option>FLAG-2024-0704: 원격 주차 보조</option>
                            <option>FLAG-2024-0812: 음성 인식 AI 비서</option>
                        </select>
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">차단 사유 * (최소 50자)</label>
                        <textarea class="w-full border border-gray-300 rounded px-3 py-2 h-24" placeholder="긴급 차단이 필요한 구체적 사유를 입력하세요. 기술적 결함, 안전 위험, 법규 위반 등..."></textarea>
                        <div class="text-xs text-gray-500 mt-1">0 / 50자 (최소)</div>
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">대상 범위</label>
                        <div class="space-y-2">
                            <label class="flex items-center">
                                <input type="radio" name="scope" class="mr-2" checked>
                                <span>전체 차량 (영향: 약 125,000대)</span>
                            </label>
                            <label class="flex items-center">
                                <input type="radio" name="scope" class="mr-2">
                                <span>특정 모델/지역</span>
                            </label>
                            <label class="flex items-center">
                                <input type="radio" name="scope" class="mr-2">
                                <span>VIN 리스트 (CSV 업로드)</span>
                            </label>
                        </div>
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">실행 시각</label>
                        <div class="space-y-2">
                            <label class="flex items-center">
                                <input type="radio" name="timing" class="mr-2" checked>
                                <span class="text-red-600 font-bold">즉시 실행 (3시간 이내 전파)</span>
                            </label>
                            <label class="flex items-center">
                                <input type="radio" name="timing" class="mr-2">
                                <span>예약 실행</span>
                                <input type="datetime-local" class="ml-2 border border-gray-300 rounded px-2 py-1">
                            </label>
                        </div>
                    </div>

                    <!-- Two-Factor Authentication -->
                    <div class="bg-yellow-50 border border-yellow-300 rounded p-4">
                        <div class="flex items-center space-x-2 mb-3">
                            <i class="fas fa-key text-yellow-600"></i>
                            <span class="font-bold text-gray-900">2단계 인증 (ASIL-D 이상 필수)</span>
                        </div>
                        <div class="flex justify-center space-x-2 mb-3">
                            <input type="text" maxlength="1" class="two-factor-input border-2 border-gray-300 rounded">
                            <input type="text" maxlength="1" class="two-factor-input border-2 border-gray-300 rounded">
                            <input type="text" maxlength="1" class="two-factor-input border-2 border-gray-300 rounded">
                            <span class="text-2xl font-bold text-gray-400">-</span>
                            <input type="text" maxlength="1" class="two-factor-input border-2 border-gray-300 rounded">
                            <input type="text" maxlength="1" class="two-factor-input border-2 border-gray-300 rounded">
                            <input type="text" maxlength="1" class="two-factor-input border-2 border-gray-300 rounded">
                        </div>
                        <button class="w-full bg-blue-600 text-white py-2 rounded hover:bg-blue-700">
                            <i class="fas fa-mobile-alt mr-2"></i>SMS로 인증코드 전송
                        </button>
                    </div>

                    <!-- Approval Chain -->
                    <div class="bg-gray-50 rounded p-4">
                        <div class="text-sm font-medium text-gray-700 mb-3">승인 체인 (ASIL 등급별)</div>
                        <div class="space-y-2 text-sm">
                            <div class="flex items-center justify-between">
                                <span>ASIL-QM (비안전): 본인</span>
                                <i class="fas fa-check-circle text-green-600"></i>
                            </div>
                            <div class="flex items-center justify-between">
                                <span>ASIL-B: 팀장 승인 필요</span>
                                <i class="fas fa-clock text-gray-400"></i>
                            </div>
                            <div class="flex items-center justify-between">
                                <span>ASIL-D: 팀장 + CTO 승인 필요</span>
                                <i class="fas fa-clock text-gray-400"></i>
                            </div>
                        </div>
                    </div>

                    <button class="w-full bg-red-600 text-white py-3 rounded-lg font-bold hover:bg-red-700 text-lg">
                        <i class="fas fa-power-off mr-2"></i>Kill Switch 발동
                    </button>

                    <div class="text-xs text-gray-500 text-center">
                        <i class="fas fa-info-circle mr-1"></i>
                        Kill Switch 발동 시 모든 활동은 감사 로그에 기록되며 되돌릴 수 없습니다.
                    </div>
                </div>
            </div>

            <!-- Right: Impact Analysis & Timeline -->
            <div class="space-y-6">
                <!-- Impact Prediction -->
                <div class="bg-white rounded-lg shadow-lg p-6">
                    <h3 class="text-lg font-bold text-gray-900 mb-4">
                        <i class="fas fa-chart-line mr-2 text-blue-600"></i>영향도 예측
                    </h3>
                    <div class="space-y-4">
                        <div>
                            <div class="flex justify-between text-sm mb-1">
                                <span class="text-gray-600">예상 영향 차량</span>
                                <span class="font-bold text-gray-900">125,342대</span>
                            </div>
                            <div class="w-full bg-gray-200 rounded-full h-2">
                                <div class="bg-red-600 h-2 rounded-full" style="width: 87%"></div>
                            </div>
                            <div class="text-xs text-gray-500 mt-1">전체 차량의 87%</div>
                        </div>

                        <div>
                            <div class="flex justify-between text-sm mb-1">
                                <span class="text-gray-600">전파 예상 시간</span>
                                <span class="font-bold text-orange-600">2시간 48분</span>
                            </div>
                            <div class="w-full bg-gray-200 rounded-full h-2">
                                <div class="bg-orange-600 h-2 rounded-full" style="width: 93%"></div>
                            </div>
                            <div class="text-xs text-gray-500 mt-1">목표: 3시간 이내 (93% 달성)</div>
                        </div>

                        <div class="bg-blue-50 rounded p-3 text-sm">
                            <div class="font-bold text-blue-900 mb-2">의존성 체크 결과</div>
                            <div class="space-y-1 text-gray-700">
                                <div><i class="fas fa-check-circle text-green-600 mr-2"></i>연관된 12개 Feature Flag 자동 비활성화</div>
                                <div><i class="fas fa-check-circle text-green-600 mr-2"></i>BOM 의존성 충돌 없음</div>
                                <div><i class="fas fa-exclamation-triangle text-yellow-600 mr-2"></i>47개 차량 오프라인 (재연결 시 적용)</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Kill Switch Timeline -->
                <div class="bg-white rounded-lg shadow-lg p-6">
                    <h3 class="text-lg font-bold text-gray-900 mb-4">
                        <i class="fas fa-history mr-2 text-purple-600"></i>최근 Kill Switch 이력
                    </h3>
                    <div class="relative border-l-2 border-gray-300 pl-6 space-y-6">
                        <!-- Timeline Item 1 -->
                        <div class="relative">
                            <div class="timeline-dot bg-red-600"></div>
                            <div class="text-xs text-gray-500 mb-1">2026-01-28 09:15</div>
                            <div class="font-bold text-gray-900">자율주행 L3 긴급 차단</div>
                            <div class="text-sm text-gray-600">Mobileye 센서 결함 | 영향: 12,847대</div>
                            <div class="text-xs text-green-600 mt-1">✓ 전파 완료 (2h 43m)</div>
                        </div>

                        <!-- Timeline Item 2 -->
                        <div class="relative">
                            <div class="timeline-dot bg-green-600"></div>
                            <div class="text-xs text-gray-500 mb-1">2026-01-20 14:22</div>
                            <div class="font-bold text-gray-900">OTA 업데이트 재개</div>
                            <div class="text-sm text-gray-600">배터리 펌웨어 v3.1.2 안정화 | 영향: 45,231대</div>
                            <div class="text-xs text-green-600 mt-1">✓ 복구 완료</div>
                        </div>

                        <!-- Timeline Item 3 -->
                        <div class="relative">
                            <div class="timeline-dot bg-red-600"></div>
                            <div class="text-xs text-gray-500 mb-1">2026-01-15 03:47</div>
                            <div class="font-bold text-gray-900">음성인식 AI 긴급 중단</div>
                            <div class="text-sm text-gray-600">개인정보 유출 의심 | 영향: 78,432대</div>
                            <div class="text-xs text-blue-600 mt-1">→ 보안팀 조사 중</div>
                        </div>

                        <!-- Timeline Item 4 -->
                        <div class="relative">
                            <div class="timeline-dot bg-yellow-600"></div>
                            <div class="text-xs text-gray-500 mb-1">2025-12-28 11:03</div>
                            <div class="font-bold text-gray-900">원격 시동 기능 일시 중단</div>
                            <div class="text-sm text-gray-600">해킹 시도 감지 | 영향: 3,421대</div>
                            <div class="text-xs text-green-600 mt-1">✓ 패치 완료 후 복구</div>
                        </div>
                    </div>
                </div>

                <!-- Statistics -->
                <div class="bg-white rounded-lg shadow-lg p-6">
                    <h3 class="text-lg font-bold text-gray-900 mb-4">
                        <i class="fas fa-chart-bar mr-2 text-green-600"></i>Kill Switch 통계 (최근 6개월)
                    </h3>
                    <div class="grid grid-cols-2 gap-4">
                        <div class="text-center p-4 bg-red-50 rounded">
                            <div class="text-3xl font-bold text-red-600">23</div>
                            <div class="text-sm text-gray-600">총 발동 횟수</div>
                        </div>
                        <div class="text-center p-4 bg-green-50 rounded">
                            <div class="text-3xl font-bold text-green-600">2h 41m</div>
                            <div class="text-sm text-gray-600">평균 전파 시간</div>
                        </div>
                        <div class="text-center p-4 bg-blue-50 rounded">
                            <div class="text-3xl font-bold text-blue-600">99.7%</div>
                            <div class="text-sm text-gray-600">성공률</div>
                        </div>
                        <div class="text-center p-4 bg-purple-50 rounded">
                            <div class="text-3xl font-bold text-purple-600">18</div>
                            <div class="text-sm text-gray-600">복구 완료</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Recent Activities -->
        <div class="bg-white rounded-lg shadow-lg p-6">
            <h2 class="text-xl font-bold text-gray-900 mb-4">
                <i class="fas fa-stream mr-2 text-gray-600"></i>실시간 활동 피드
            </h2>
            <div class="space-y-3">
                <div class="flex items-center justify-between py-3 border-b">
                    <div class="flex items-center space-x-4">
                        <i class="fas fa-power-off text-red-600"></i>
                        <div>
                            <div class="font-medium text-gray-900">Kill Switch 발동: FLAG-2024-0523</div>
                            <div class="text-sm text-gray-500">이성룡 부장 | 2026-01-28 09:15:33</div>
                        </div>
                    </div>
                    <span class="text-red-600 font-bold">ACTIVE</span>
                </div>

                <div class="flex items-center justify-between py-3 border-b">
                    <div class="flex items-center space-x-4">
                        <i class="fas fa-sync text-blue-600"></i>
                        <div>
                            <div class="font-medium text-gray-900">전파 상태 업데이트: 12,847대 중 12,847대 완료</div>
                            <div class="text-sm text-gray-500">시스템 자동 | 2026-01-28 11:58:47</div>
                        </div>
                    </div>
                    <span class="text-green-600 font-bold">100%</span>
                </div>

                <div class="flex items-center justify-between py-3 border-b">
                    <div class="flex items-center space-x-4">
                        <i class="fas fa-bell text-yellow-600"></i>
                        <div>
                            <div class="font-medium text-gray-900">Slack 알림 발송: #safety-critical 채널</div>
                            <div class="text-sm text-gray-500">시스템 자동 | 2026-01-28 09:15:34</div>
                        </div>
                    </div>
                    <span class="text-gray-600">SENT</span>
                </div>

                <div class="flex items-center justify-between py-3">
                    <div class="flex items-center space-x-4">
                        <i class="fas fa-file-alt text-purple-600"></i>
                        <div>
                            <div class="font-medium text-gray-900">감사 로그 기록 완료</div>
                            <div class="text-sm text-gray-500">시스템 자동 | 2026-01-28 09:15:34</div>
                        </div>
                    </div>
                    <span class="text-green-600">LOGGED</span>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Update current time
        setInterval(() => {
            const now = new Date();
            document.getElementById('current-time').textContent = 
                now.toLocaleString('ko-KR', { 
                    year: 'numeric', 
                    month: '2-digit', 
                    day: '2-digit',
                    hour: '2-digit', 
                    minute: '2-digit', 
                    second: '2-digit',
                    hour12: false 
                }) + ' KST';
        }, 1000);

        // Auto-focus next input in 2FA
        const inputs = document.querySelectorAll('.two-factor-input');
        inputs.forEach((input, index) => {
            input.addEventListener('input', (e) => {
                if (e.target.value.length === 1 && index < inputs.length - 1) {
                    inputs[index + 1].focus();
                }
            });
            input.addEventListener('keydown', (e) => {
                if (e.key === 'Backspace' && !e.target.value && index > 0) {
                    inputs[index - 1].focus();
                }
            });
        });
    </script>
</body>
</html>
