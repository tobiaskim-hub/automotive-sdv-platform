# FleetFlag - ì‹œìŠ¤í…œ ìš”êµ¬ì‚¬ì–‘ì„œ (SRS)

**System Requirements Specification**

---

## ë¬¸ì„œ ì •ë³´

| í•­ëª© | ë‚´ìš© |
|------|------|
| ë¬¸ì„œëª… | FleetFlag ì‹œìŠ¤í…œ ìš”êµ¬ì‚¬ì–‘ì„œ |
| ë²„ì „ | v1.0 |
| ì‘ì„±ì¼ | 2026-02-01 |
| ì‘ì„±ì | FleetFlag Team |
| ìƒíƒœ | ğŸŸ¡ Review |
| ë¶„ë¥˜ | CONFIDENTIAL |

---

## 1. ê°œìš” (Overview)

### 1.1 ëª©ì  (Purpose)

ë³¸ ë¬¸ì„œëŠ” í˜„ëŒ€ìë™ì°¨ SDV(Software Defined Vehicle) ì „í™˜ì„ ìœ„í•œ Feature Flag Management Systemì¸ **FleetFlag**ì˜ ì‹œìŠ¤í…œ ìš”êµ¬ì‚¬í•­ì„ ì •ì˜í•©ë‹ˆë‹¤.

### 1.2 ë²”ìœ„ (Scope)

FleetFlagëŠ” ë‹¤ìŒ ê¸°ëŠ¥ì„ ì œê³µí•©ë‹ˆë‹¤:

1. **Feature Flag ìƒì„± ë° ê´€ë¦¬**: ì½”ë“œ ë°°í¬ ì—†ì´ ê¸°ëŠ¥ í™œì„±í™”/ë¹„í™œì„±í™”
2. **íƒ€ê²ŸíŒ… ê·œì¹™**: ì°¨ëŸ‰ ì†ì„± ê¸°ë°˜ ì ì§„ì  ë°°í¬
3. **Kill Switch**: ê¸´ê¸‰ ìƒí™© ì‹œ 3ì´ˆ ì´ë‚´ ê¸°ëŠ¥ ë¹„í™œì„±í™”
4. **A/B ì‹¤í—˜**: ì‹¤ì‹œê°„ ë©”íŠ¸ë¦­ ìˆ˜ì§‘ ë° ë¶„ì„
5. **í˜‘ë ¥ì‚¬ API ì œì–´**: Tier 1 í˜‘ë ¥ì‚¬ ë¸”ë™ë°•ìŠ¤ SW ì œì–´ (API Gateway)
6. **ì˜¤í”„ë¼ì¸ ì•ˆì •ì„±**: ë„¤íŠ¸ì›Œí¬ ë‹¨ì ˆ ì‹œ 7ì¼ê°„ ë¡œì»¬ ìºì‹œë¡œ ë™ì‘

### 1.3 ëŒ€ìƒ ì‚¬ìš©ì (Target Users)

- **í˜„ëŒ€ì°¨ SW ê°œë°œíŒ€**: ADAS, ë°°í„°ë¦¬, Infotainment íŒ€
- **QA/Test ì—”ì§€ë‹ˆì–´**: ì‹¤í—˜ ë° ê²€ì¦
- **DevOps ì—”ì§€ë‹ˆì–´**: ë°°í¬ ë° ëª¨ë‹ˆí„°ë§
- **Tier 1 í˜‘ë ¥ì‚¬**: API ì—°ë™
- **Safety íŒ€**: ASIL-D Flag ìŠ¹ì¸

### 1.4 ì°¸ì¡° ë¬¸ì„œ (References)

- [ISO 26262] Road vehicles - Functional safety
- [AUTOSAR Adaptive Platform] AUTOSAR AP R21-11
- [OpenFeature Specification] v0.7.0
- [í˜„ëŒ€ì°¨ SDV ì „í™˜ ì „ëµ ë³´ê³ ì„œ] 2026-01

---

## 2. ì‹œìŠ¤í…œ ì»¨í…ìŠ¤íŠ¸ (System Context)

### 2.1 ì‹œìŠ¤í…œ ê²½ê³„ (System Boundary)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      External Systems                           â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚ Admin Users  â”‚  â”‚ Tier1 APIs   â”‚  â”‚ Vehicles     â”‚         â”‚
â”‚  â”‚ (Browser)    â”‚  â”‚ (HTTPS)      â”‚  â”‚ (IGN ON)     â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚         â”‚                 â”‚                  â”‚                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                 â”‚                  â”‚
          â”‚ HTTPS           â”‚ HTTPS/gRPC       â”‚ gRPC/mTLS
          â”‚                 â”‚                  â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     FleetFlag System                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                 Control Plane (Azure)                   â”‚    â”‚
â”‚  â”‚  - Admin Dashboard                                      â”‚    â”‚
â”‚  â”‚  - API Server (Rust)                                    â”‚    â”‚
â”‚  â”‚  - Flipt Engine (Go)                                    â”‚    â”‚
â”‚  â”‚  - PostgreSQL, Redis, ClickHouse                        â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                           â”‚                                     â”‚
â”‚                           â”‚ gRPC/WebSocket                      â”‚
â”‚                           â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚              Vehicle Plane (ì°¨ëŸ‰)                        â”‚   â”‚
â”‚  â”‚  - FleetFlag Agent (Rust Core, 64MB)                    â”‚   â”‚
â”‚  â”‚  - SQLite Cache (7-day TTL)                             â”‚   â”‚
â”‚  â”‚  - SDK: C++/Python/Rust                                 â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 ì™¸ë¶€ ì¸í„°í˜ì´ìŠ¤ (External Interfaces)

| ì¸í„°í˜ì´ìŠ¤ | í”„ë¡œí† ì½œ | ì„¤ëª… |
|-----------|---------|------|
| Admin Dashboard | HTTPS | ê´€ë¦¬ì ì›¹ UI |
| Tier 1 API Gateway | HTTPS/gRPC | í˜‘ë ¥ì‚¬ API íŠ¸ë˜í”½ ì œì–´ |
| Vehicle Agent | gRPC/mTLS | ì°¨ëŸ‰-í´ë¼ìš°ë“œ ì–‘ë°©í–¥ í†µì‹  |
| WebSocket | WSS | Kill Switch ì‹¤ì‹œê°„ í‘¸ì‹œ |
| Azure Monitor | HTTPS | ëª¨ë‹ˆí„°ë§ ë° ë¡œê¹… |

---

## 3. ê¸°ëŠ¥ ìš”êµ¬ì‚¬í•­ (Functional Requirements)

### 3.1 Feature Flag ê´€ë¦¬ (FR-001 ~ FR-009)

#### FR-001: Flag ìƒì„± ë° ë©”íƒ€ë°ì´í„° ê´€ë¦¬
- **ìš°ì„ ìˆœìœ„**: â­â­â­â­â­ (Critical)
- **ì„¤ëª…**: ê´€ë¦¬ìëŠ” Feature Flagë¥¼ ìƒì„±í•˜ê³  ë©”íƒ€ë°ì´í„°ë¥¼ ê´€ë¦¬í•  ìˆ˜ ìˆì–´ì•¼ í•¨
- **í•„ë“œ**:
  - `key` (string, immutable): ê³ ìœ  ì‹ë³„ì (ì˜ˆ: `adas_lane_keep_v2`)
  - `name` (string): í‘œì‹œ ì´ë¦„
  - `description` (string): ìƒì„¸ ì„¤ëª…
  - `type` (enum): Boolean, String, Number, JSON
  - `default_value`: ë„¤íŠ¸ì›Œí¬ ì‹¤íŒ¨ ì‹œ fallback ê°’
  - `safety_level` (enum): Non-Critical, Safety-Relevant, ASIL-B, ASIL-D
  - `enabled` (boolean): í™œì„±í™” ìƒíƒœ
  - `created_at`, `updated_at`, `created_by`
- **ì œì•½ì‚¬í•­**:
  - Flag `key`ëŠ” ìƒì„± í›„ ë³€ê²½ ë¶ˆê°€ (immutable)
  - ASIL-D ë“±ê¸‰ FlagëŠ” 2ë‹¨ê³„ ìŠ¹ì¸ í•„ìš” (Safety íŒ€)
- **ìˆ˜ìš© ê¸°ì¤€**: 
  - ê´€ë¦¬ìê°€ Dashboardì—ì„œ Flag ìƒì„± ê°€ëŠ¥
  - ASIL-D FlagëŠ” Safety íŒ€ ìŠ¹ì¸ í›„ì—ë§Œ í™œì„±í™” ê°€ëŠ¥

#### FR-002: íƒ€ê²ŸíŒ… ê·œì¹™ (Targeting Rules)
- **ìš°ì„ ìˆœìœ„**: â­â­â­â­â­ (Critical)
- **ì„¤ëª…**: FlagëŠ” ì°¨ëŸ‰ ì†ì„± ê¸°ë°˜ íƒ€ê²ŸíŒ… ê·œì¹™ì„ ì§€ì›í•´ì•¼ í•¨
- **ê·œì¹™ íƒ€ì…**:
  1. **ì°¨ëŸ‰ í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸**: VIN ëª©ë¡ (ì˜ˆ: `["KMH1234...", "KMH5678..."]`)
  2. **ì°¨ëŸ‰ ëª¨ë¸**: Ioniq 5 Gen2, Ioniq 6, GV70 ë“±
  3. **SW ë²„ì „**: UMOS >= 2.5.0
  4. **ì‚¬ìš©ì ì†ì„±**: ì§€ì—­(ë¶ë¯¸/ìœ ëŸ½/í•œêµ­), Beta Tester ì—¬ë¶€
  5. **í™˜ê²½ë³„**: Development, Staging, Production
  6. **Percentage Rollout**: 10% â†’ 25% â†’ 50% â†’ 100% ì ì§„ì  ë°°í¬
  7. **Kill Switch**: ëª¨ë“  íƒ€ê²ŸíŒ… ë¬´ì‹œí•˜ê³  ê°•ì œ ë¹„í™œì„±í™” (ìµœìš°ì„  ìˆœìœ„)
- **í‰ê°€ ìš°ì„ ìˆœìœ„** (First Match Wins):
  1. Kill Switch (ìµœìš°ì„ )
  2. VIN í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸
  3. Percentage Rollout
  4. ì°¨ëŸ‰ ì†ì„± í•„í„°
  5. Default Value
- **ìˆ˜ìš© ê¸°ì¤€**:
  - ë™ì¼ VINì€ í•­ìƒ ë™ì¼ Variant í• ë‹¹ (Sticky Assignment)
  - ê·œì¹™ í‰ê°€ ì‹œê°„ < 0.1ms (ë¡œì»¬ ìºì‹œ)

#### FR-003: ë‹¤ì¤‘ í™˜ê²½ ì§€ì› (Multi-Environment)
- **ìš°ì„ ìˆœìœ„**: â­â­â­â­ (High)
- **ì„¤ëª…**: ê°œë°œ/ìŠ¤í…Œì´ì§•/í”„ë¡œë•ì…˜ í™˜ê²½ë³„ ë…ë¦½ì ì¸ Flag ì„¤ì •
- **í™˜ê²½ íƒ€ì…**:
  - `Development`: ì „ì²´ ì°¨ëŸ‰ í™œì„±í™”, ë¹ ë¥¸ í…ŒìŠ¤íŠ¸
  - `Staging`: Beta Testerë§Œ í™œì„±í™”
  - `Production`: ì‹¤ì œ ê³ ê° ì°¨ëŸ‰, ìŠ¹ì¸ í•„ìš”
- **í”„ë¡œëª¨ì…˜**: Dev â†’ Staging â†’ Production ë‹¨ê³„ì  ìŠ¹ê²©
- **ìˆ˜ìš© ê¸°ì¤€**:
  - Production Flag ë³€ê²½ ì‹œ 2ë‹¨ê³„ ìŠ¹ì¸ workflow
  - í™˜ê²½ë³„ ë…ë¦½ì ì¸ íƒ€ê²ŸíŒ… ê·œì¹™

### 3.2 API Gateway íŠ¸ë˜í”½ ì œì–´ (FR-010 ~ FR-019)

#### FR-010: API Gateway ë ˆë²¨ Feature Flag
- **ìš°ì„ ìˆœìœ„**: â­â­â­â­â­ (Critical)
- **ì„¤ëª…**: í˜‘ë ¥ì‚¬(Tier 1) API í˜¸ì¶œì„ FleetFlagë¡œ ì œì–´
- **ì œì–´ ë™ì‘**:
  - `ALLOW`: API í˜¸ì¶œ í—ˆìš©
  - `DENY`: API í˜¸ì¶œ ì°¨ë‹¨ (403 Forbidden ë°˜í™˜)
  - `REDIRECT`: ëŒ€ì²´ ì—”ë“œí¬ì¸íŠ¸ë¡œ ë¦¬ë‹¤ì´ë ‰ì…˜
  - `THROTTLE`: Rate Limiting ì ìš©
  - `CANARY`: ì‹ ê·œ ë²„ì „ìœ¼ë¡œ ì¼ë¶€ íŠ¸ë˜í”½ ì „í™˜
- **í†µí•©**:
  - Kong API Gateway ì—°ë™
  - Istio Service Mesh ì—°ë™
  - LaunchDarkly Edge SDK ì—°ë™ (ì˜µì…˜)
- **ì„±ëŠ¥ ëª©í‘œ**: ì˜¤ë²„í—¤ë“œ < 5ms
- **ìˆ˜ìš© ê¸°ì¤€**:
  - í˜‘ë ¥ì‚¬ ì†ŒìŠ¤ ì½”ë“œ ìˆ˜ì • ì—†ì´ 70-80% ê¸°ëŠ¥ ì œì–´ ê°€ëŠ¥
  - API í˜¸ì¶œ ì‹œ Flag í‰ê°€ ê²°ê³¼ ì¦‰ì‹œ ë°˜ì˜

#### FR-011: Kill Switch (ê¸´ê¸‰ ë¹„í™œì„±í™”)
- **ìš°ì„ ìˆœìœ„**: â­â­â­â­â­ (Critical)
- **ì„¤ëª…**: ì•ˆì „ ë¬¸ì œ ë°œìƒ ì‹œ 3ì´ˆ ì´ë‚´ ì „ì²´ ì°¨ëŸ‰ì— Flag ë¹„í™œì„±í™”
- **í†µì‹  ë°©ì‹**:
  - WebSocket Push Notification (ìš°ì„ )
  - gRPC Streaming (ë°±ì—…)
  - ì£¼ê¸°ì  í´ë§ (ìµœí›„ ìˆ˜ë‹¨, 60ì´ˆ ê°„ê²©)
- **ì˜¤í”„ë¼ì¸ ì²˜ë¦¬**: ì°¨ëŸ‰ ì¬ì—°ê²° ì‹œ ì¦‰ì‹œ ë™ê¸°í™”
- **ì•Œë¦¼**:
  - Slack/Teams ìë™ ì•Œë¦¼
  - ì˜í–¥ë°›ëŠ” ì°¨ëŸ‰ ìˆ˜ í‘œì‹œ
  - Dashboardì— ğŸ”´ ê¸´ê¸‰ ê²½ê³  í‘œì‹œ
- **ìˆ˜ìš© ê¸°ì¤€**:
  - Kill Switch í™œì„±í™” â†’ ì „ì²´ ì°¨ëŸ‰ ë°˜ì˜ < 3ì´ˆ
  - 99.9% ì°¨ëŸ‰ì— 3ì´ˆ ì´ë‚´ ì „ë‹¬ (P99 ê¸°ì¤€)

### 3.3 In-Code Feature Toggles (FR-020 ~ FR-029)

#### FR-020: SDKë¥¼ í†µí•œ ì½”ë“œ ë ˆë²¨ í† ê¸€
- **ìš°ì„ ìˆœìœ„**: â­â­â­â­ (High)
- **ì„¤ëª…**: ì• í”Œë¦¬ì¼€ì´ì…˜ ì½”ë“œì—ì„œ SDKë¡œ Flag ê°’ ì¡°íšŒ
- **SDK ì–¸ì–´**: C++ (AUTOSAR), Python (AI/ML), Rust (UMOS Core)
- **API ì˜ˆì‹œ** (C++):
  ```cpp
  #include <fleetflag/client.h>
  
  auto client = FleetFlag::Client::create("config.json");
  
  if (client->isEnabled("adas_lane_keep_v2")) {
      // ì‹ ê·œ ì•Œê³ ë¦¬ì¦˜ ì‹¤í–‰
      runNewLaneKeepAlgorithm();
  } else {
      // ê¸°ì¡´ ì•Œê³ ë¦¬ì¦˜ ì‹¤í–‰
      runOldLaneKeepAlgorithm();
  }
  ```
- **ì„±ëŠ¥ ëª©í‘œ**: 
  - ë¡œì»¬ ìºì‹œ ì¡°íšŒ < 0.1ms
  - ë„¤íŠ¸ì›Œí¬ ì‹¤íŒ¨ ì‹œ default value ì¦‰ì‹œ ë°˜í™˜
- **ìˆ˜ìš© ê¸°ì¤€**:
  - C++ SDK ì»´íŒŒì¼ ì‹œê°„ < 1ì´ˆ ì¶”ê°€
  - Python SDK import ì‹œê°„ < 10ms

#### FR-021: Shadow Mode (A/B ì‹¤í—˜)
- **ìš°ì„ ìˆœìœ„**: â­â­â­ (Medium)
- **ì„¤ëª…**: ì‹ ê·œ ì•Œê³ ë¦¬ì¦˜ì„ ë°±ê·¸ë¼ìš´ë“œì—ì„œ ì‹¤í–‰í•˜ê³  ë©”íŠ¸ë¦­ ìˆ˜ì§‘ (ì‚¬ìš©ì ì˜í–¥ ì—†ìŒ)
- **API ì˜ˆì‹œ**:
  ```cpp
  client->withShadow("new_algorithm", [&]() {
      // Shadow mode: ê²°ê³¼ëŠ” ë¬´ì‹œ, ë©”íŠ¸ë¦­ë§Œ ìˆ˜ì§‘
      auto result = runNewAlgorithm();
      client->reportMetric("new_algorithm", "accuracy", result.accuracy);
  });
  ```
- **ìˆ˜ìš© ê¸°ì¤€**:
  - Shadow ì‹¤í–‰ ì‹œê°„ì´ ë©”ì¸ ì‹¤í–‰ì— ì˜í–¥ ì—†ìŒ (ë¹„ë™ê¸° ì²˜ë¦¬)
  - ë©”íŠ¸ë¦­ì€ ClickHouseì— ì‹¤ì‹œê°„ ìˆ˜ì§‘

### 3.4 ê²½ëŸ‰ Agent (FR-030 ~ FR-039)

#### FR-030: Rust ê¸°ë°˜ ê²½ëŸ‰ Agent
- **ìš°ì„ ìˆœìœ„**: â­â­â­â­â­ (Critical)
- **ì„¤ëª…**: ì°¨ëŸ‰ ECUì—ì„œ ë™ì‘í•˜ëŠ” ê²½ëŸ‰ Agent
- **ë¦¬ì†ŒìŠ¤ ì œì•½**:
  - ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰: â‰¤ 64MB
  - CPU ì‚¬ìš©ë¥ : â‰¤ 2% (í‰ê· )
  - ë°”ì´ë„ˆë¦¬ í¬ê¸°: â‰¤ 10MB (ì••ì¶•)
- **ê¸°ëŠ¥**:
  - gRPC í´ë¼ì´ì–¸íŠ¸ (mTLS)
  - SQLite ë¡œì»¬ ìºì‹œ
  - WebSocket ìˆ˜ì‹  (Kill Switch)
  - ì£¼ê¸°ì  ë™ê¸°í™” (5ë¶„ë§ˆë‹¤)
- **no_std ì§€ì›**: RTOS í™˜ê²½ ì§€ì› (FreeRTOS, QNX)
- **ìˆ˜ìš© ê¸°ì¤€**:
  - ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ì‹¤ì¸¡ < 64MB (Valgrind ê²€ì¦)
  - CPU ì‚¬ìš©ë¥  < 2% (ì°¨ëŸ‰ í…”ë ˆë©”íŠ¸ë¦¬ ìˆ˜ì§‘)

#### FR-031: ì˜¤í”„ë¼ì¸ ëª¨ë“œ (Offline Mode)
- **ìš°ì„ ìˆœìœ„**: â­â­â­â­â­ (Critical)
- **ì„¤ëª…**: ë„¤íŠ¸ì›Œí¬ ë‹¨ì ˆ ì‹œ ë¡œì»¬ ìºì‹œë¡œ ë™ì‘
- **ìºì‹œ TTL**: 7ì¼
- **ë™ì‘**:
  1. ë„¤íŠ¸ì›Œí¬ ì •ìƒ: 5ë¶„ë§ˆë‹¤ ì „ì²´ Flag ë™ê¸°í™”
  2. ë„¤íŠ¸ì›Œí¬ ì‹¤íŒ¨: ë¡œì»¬ SQLite ìºì‹œ ì‚¬ìš©
  3. ìºì‹œ ë§Œë£Œ (7ì¼ ì´ˆê³¼): Default Valueë¡œ fallback
  4. ë„¤íŠ¸ì›Œí¬ ë³µêµ¬: Delta Syncë¡œ ë³€ê²½ì‚¬í•­ë§Œ ì „ì†¡
- **ìˆ˜ìš© ê¸°ì¤€**:
  - 7ì¼ ë™ì•ˆ ì˜¤í”„ë¼ì¸ ìƒíƒœì—ì„œë„ Flag í‰ê°€ ì •ìƒ ë™ì‘
  - ë„¤íŠ¸ì›Œí¬ ë³µêµ¬ ì‹œ 1ë¶„ ì´ë‚´ ìµœì‹  ìƒíƒœ ë™ê¸°í™”

### 3.5 A/B ì‹¤í—˜ (FR-040 ~ FR-049)

#### FR-040: A/B ì‹¤í—˜ ì„¤ê³„
- **ìš°ì„ ìˆœìœ„**: â­â­â­ (Medium)
- **ì„¤ëª…**: ë‘ Variantë¥¼ ë¹„êµí•˜ëŠ” A/B ì‹¤í—˜ ì„¤ì •
- **ì„¤ì • í•­ëª©**:
  - Control Variant (ê¸°ì¡´ ì•Œê³ ë¦¬ì¦˜)
  - Treatment Variant (ì‹ ê·œ ì•Œê³ ë¦¬ì¦˜)
  - Primary Metric (ì˜ˆ: ì°¨ì„  ì´íƒˆ íšŸìˆ˜)
  - Secondary Metrics (ì˜ˆ: ì‚¬ìš©ì ë§Œì¡±ë„)
  - ìƒ˜í”Œ í¬ê¸°, ì‹¤í—˜ ê¸°ê°„, ì‹ ë¢° ìˆ˜ì¤€ (95%)
- **ìë™í™”**:
  - í†µê³„ì  ìœ ì˜ì„± íŒì • (Chi-squared test)
  - ìŠ¹ë¦¬ Variant ìë™ ì„ íƒ
  - ìë™ ë¡¤ì•„ì›ƒ ë˜ëŠ” ë¡¤ë°±
- **ìˆ˜ìš© ê¸°ì¤€**:
  - ì‹¤í—˜ ê²°ê³¼ê°€ Dashboardì— ì‹¤ì‹œê°„ í‘œì‹œ
  - 95% ì‹ ë¢° ìˆ˜ì¤€ì—ì„œ ìœ ì˜ë¯¸í•œ ì°¨ì´ ê²€ì¶œ

#### FR-041: ì‹¤ì‹œê°„ ë©”íŠ¸ë¦­ ìˆ˜ì§‘
- **ìš°ì„ ìˆœìœ„**: â­â­â­â­ (High)
- **ì„¤ëª…**: ì°¨ëŸ‰ì—ì„œ ë©”íŠ¸ë¦­ì„ ìˆ˜ì§‘í•˜ê³  ClickHouseì— ì €ì¥
- **ë©”íŠ¸ë¦­ íƒ€ì…**:
  - Counter (ì˜ˆ: API í˜¸ì¶œ íšŸìˆ˜)
  - Gauge (ì˜ˆ: ë°°í„°ë¦¬ ì˜¨ë„)
  - Histogram (ì˜ˆ: ì‘ë‹µ ì‹œê°„ ë¶„í¬)
- **íŒŒì´í”„ë¼ì¸**:
  - ì°¨ëŸ‰ Agent â†’ gRPC â†’ API Server â†’ Azure Event Hubs â†’ ClickHouse
  - ë°°ì¹˜ ì „ì†¡ (1ë¶„ë§ˆë‹¤ ìµœëŒ€ 1000ê°œ)
- **ì„±ëŠ¥ ëª©í‘œ**:
  - End-to-end latency < 5ì´ˆ
  - ì²˜ë¦¬ëŸ‰: 500,000 events/sec
- **ìˆ˜ìš© ê¸°ì¤€**:
  - ClickHouseì— ì‹¤ì‹œê°„ ì¿¼ë¦¬ ê°€ëŠ¥ (< 1ì´ˆ)
  - Grafana Dashboardì— 5ì´ˆ ì§€ì—°ìœ¼ë¡œ í‘œì‹œ

### 3.6 ë³´ì•ˆ ë° ì¸ì¦ (FR-050 ~ FR-059)

#### FR-050: API Key ì¸ì¦
- **ìš°ì„ ìˆœìœ„**: â­â­â­â­â­ (Critical)
- **ì„¤ëª…**: Tier 1 í˜‘ë ¥ì‚¬ëŠ” API Keyë¡œ ì¸ì¦
- **Key í¬ë§·**: `ff_api_key_tier1_companyA_<32_chars_random>`
- **ê¶Œí•œ ë ˆë²¨**:
  - `READ`: Flag í‰ê°€ë§Œ ê°€ëŠ¥
  - `WRITE`: Flag ìƒì„±/ìˆ˜ì • ê°€ëŠ¥
  - `ADMIN`: ëª¨ë“  ì‘ì—… ê°€ëŠ¥
- **Rate Limiting**: 10,000 req/min per API Key
- **ìˆ˜ìš© ê¸°ì¤€**:
  - ìœ íš¨í•˜ì§€ ì•Šì€ API KeyëŠ” 401 Unauthorized ë°˜í™˜
  - Rate Limit ì´ˆê³¼ ì‹œ 429 Too Many Requests ë°˜í™˜

#### FR-051: SDK ë° ë¬¸ì„œ
- **ìš°ì„ ìˆœìœ„**: â­â­â­â­ (High)
- **ì„¤ëª…**: ê°œë°œì ì¹œí™”ì ì¸ SDK ë° ë¬¸ì„œ ì œê³µ
- **SDK ìš”êµ¬ì‚¬í•­**:
  - C++ SDK: CMake ë¹Œë“œ, Header-only ì˜µì…˜
  - Python SDK: pip install, Type hints
  - Rust SDK: Cargo crate, no_std ì§€ì›
- **ë¬¸ì„œ**:
  - OpenAPI 3.0 Specification
  - ì½”ë“œ ì˜ˆì‹œ (Quickstart)
  - í†µí•© ê°€ì´ë“œ (AUTOSAR, UMOS)
  - TAM(Technical Account Manager) ì§€ì›
- **ìˆ˜ìš© ê¸°ì¤€**:
  - ê°œë°œìê°€ 30ë¶„ ì´ë‚´ì— ì²« Flag í†µí•© ì™„ë£Œ
  - SDK ë‹¤ìš´ë¡œë“œ/ì„¤ì¹˜ < 5ë¶„

#### FR-060: mTLS (Mutual TLS)
- **ìš°ì„ ìˆœìœ„**: â­â­â­â­â­ (Critical)
- **ì„¤ëª…**: ì°¨ëŸ‰-í´ë¼ìš°ë“œ í†µì‹ ì€ mTLSë¡œ ì•”í˜¸í™”
- **ì¸ì¦ì„œ**:
  - ì°¨ëŸ‰ ì¸ì¦ì„œ: VIN ê¸°ë°˜, ì°¨ëŸ‰ ì œì¡° ì‹œ ë°œê¸‰
  - ì„œë²„ ì¸ì¦ì„œ: Azure Key Vault ê´€ë¦¬
- **ê°±ì‹ **: ìë™ ê°±ì‹  (90ì¼ë§ˆë‹¤)
- **ìˆ˜ìš© ê¸°ì¤€**:
  - ìœ íš¨í•˜ì§€ ì•Šì€ ì¸ì¦ì„œëŠ” ì—°ê²° ê±°ë¶€
  - ì¸ì¦ì„œ ê²€ì¦ ì‹œê°„ < 100ms

#### FR-061: Audit Log (ê°ì‚¬ ë¡œê·¸)
- **ìš°ì„ ìˆœìœ„**: â­â­â­â­ (High)
- **ì„¤ëª…**: ëª¨ë“  Flag ë³€ê²½ ì´ë ¥ ê¸°ë¡
- **ë¡œê·¸ í•­ëª©**:
  - ì‹œê°„, ì‚¬ìš©ì, ì‘ì—… (CREATE/UPDATE/DELETE/KILL_SWITCH)
  - ë³€ê²½ ì „/í›„ ê°’
  - IP ì£¼ì†Œ, User Agent
- **ë³´ì¡´ ê¸°ê°„**: 7ë…„ (ISO 26262 ìš”êµ¬ì‚¬í•­)
- **ìˆ˜ìš© ê¸°ì¤€**:
  - Dashboardì—ì„œ Audit Log ì¡°íšŒ ê°€ëŠ¥
  - CSV ë‹¤ìš´ë¡œë“œ ê°€ëŠ¥

---

## 4. ë¹„ê¸°ëŠ¥ ìš”êµ¬ì‚¬í•­ (Non-Functional Requirements)

### 4.1 ì„±ëŠ¥ (Performance)

#### NFR-001: API ì‘ë‹µ ì‹œê°„
- **ëª©í‘œ**: P95 < 50ms, P99 < 100ms
- **ì¸¡ì •**: Prometheus + Grafana
- **SLA**: 99.9% ìš”ì²­ì´ 100ms ì´ë‚´ ì‘ë‹µ

#### NFR-002: Agent ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ëŸ‰
- **ë©”ëª¨ë¦¬**: â‰¤ 64MB (RSS)
- **CPU**: â‰¤ 2% (í‰ê· ), â‰¤ 5% (peak)
- **ë””ìŠ¤í¬**: â‰¤ 10MB (ë°”ì´ë„ˆë¦¬ + ìºì‹œ)
- **ì¸¡ì •**: ì°¨ëŸ‰ í…”ë ˆë©”íŠ¸ë¦¬

#### NFR-003: Kill Switch ì „íŒŒ ì‹œê°„
- **ëª©í‘œ**: < 3ì´ˆ (P99)
- **ì¸¡ì •**: WebSocket ì´ë²¤íŠ¸ íƒ€ì„ìŠ¤íƒ¬í”„
- **SLA**: 99.9% ì°¨ëŸ‰ì— 3ì´ˆ ì´ë‚´ ì „ë‹¬

#### NFR-004: API Gateway ì˜¤ë²„í—¤ë“œ
- **ëª©í‘œ**: < 5ms (Flag í‰ê°€ ì‹œê°„)
- **ì¸¡ì •**: Kong/Istio ë©”íŠ¸ë¦­
- **SLA**: 95% ìš”ì²­ì´ 5ms ì´ë‚´

### 4.2 ê°€ìš©ì„± (Availability)

#### NFR-010: ì‹œìŠ¤í…œ ê°€ìš©ì„±
- **ëª©í‘œ**: 99.9% (ì—°ê°„ ë‹¤ìš´íƒ€ì„ < 8.76ì‹œê°„)
- **ì¸¡ì •**: Azure Monitor Uptime
- **ê³ ê°€ìš©ì„± ì „ëµ**:
  - Multi-AZ ë°°í¬ (3ê°œ Availability Zone)
  - Auto-scaling (HPA)
  - Health Check (Liveness, Readiness Probe)

#### NFR-011: ë°ì´í„°ë² ì´ìŠ¤ ê°€ìš©ì„±
- **PostgreSQL**: 99.95% (Azure Managed)
- **Redis**: 99.9% (Sentinel HA)
- **ClickHouse**: 99.5% (VM Scale Set)

#### NFR-012: ì˜¤í”„ë¼ì¸ ì•ˆì •ì„±
- **ì°¨ëŸ‰ Agent**: 7ì¼ê°„ ì˜¤í”„ë¼ì¸ ìƒíƒœì—ì„œë„ ì •ìƒ ë™ì‘
- **ìºì‹œ ë§Œë£Œ ì‹œ**: Default Valueë¡œ ì•ˆì „í•˜ê²Œ fallback

### 4.3 í™•ì¥ì„± (Scalability)

#### NFR-020: ì°¨ëŸ‰ ê·œëª¨
- **Phase 1**: 10ëŒ€ (PoC)
- **Phase 2**: 100ëŒ€ (Beta)
- **Phase 3**: 10,000ëŒ€ (ì–‘ì‚°)
- **ìµœì¢… ëª©í‘œ**: 100,000ëŒ€

#### NFR-021: API ì²˜ë¦¬ëŸ‰
- **ëª©í‘œ**: 500,000 req/sec (Peak)
- **ìˆ˜í‰ í™•ì¥**: Kubernetes HPA (3 ~ 20 pods)
- **ë¶€í•˜ í…ŒìŠ¤íŠ¸**: K6, Locust

#### NFR-022: Flag ìˆ˜
- **ëª©í‘œ**: 10,000ê°œ Flag ì§€ì›
- **Flagë‹¹ ê·œì¹™**: ìµœëŒ€ 50ê°œ
- **ìºì‹œ ì „ëµ**: Redis (Hot Flags), PostgreSQL (Cold Flags)

### 4.4 í˜¸í™˜ì„± (Compatibility)

#### NFR-030: ì°¨ëŸ‰ í”Œë«í¼
- **UMOS**: 42dot UMOS 2.5.0 ì´ìƒ
- **AUTOSAR**: AUTOSAR Adaptive Platform R21-11
- **SoC**: Snapdragon Ride Flex, NVIDIA Drive Orin

#### NFR-031: í´ë¼ìš°ë“œ í”Œë«í¼
- **Azure**: AKS (Kubernetes 1.28+)
- **ë¦¬ì „**: Korea Central, Southeast Asia, West Europe

#### NFR-032: ë¸Œë¼ìš°ì € (Dashboard)
- **Chrome**: ìµœì‹  ë²„ì „
- **Edge**: ìµœì‹  ë²„ì „
- **Safari**: 16.0 ì´ìƒ

### 4.5 ë³´ì•ˆ (Security)

#### NFR-040: ë°ì´í„° ì•”í˜¸í™”
- **At Rest**: AES-256 (TDE)
- **In Transit**: TLS 1.3 (minimum)
- **Vehicle**: mTLS + Certificate Pinning

#### NFR-041: ì¸ì¦/ì¸ê°€
- **Admin**: JWT (RS256, 1-hour expiry)
- **Tier1**: API Key (SHA-256 hashed)
- **Vehicle**: mTLS (VIN-based certificate)

#### NFR-042: ì·¨ì•½ì  ìŠ¤ìº”
- **ì£¼ê¸°**: ì›” 1íšŒ
- **ë„êµ¬**: Trivy, Snyk, OWASP ZAP
- **SLA**: Critical ì·¨ì•½ì  7ì¼ ì´ë‚´ íŒ¨ì¹˜

### 4.6 ìœ ì§€ë³´ìˆ˜ì„± (Maintainability)

#### NFR-050: ì½”ë“œ í’ˆì§ˆ
- **í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€**: > 80%
- **ë¦°íŠ¸**: Clippy (Rust), ESLint (TypeScript)
- **CI/CD**: GitHub Actions

#### NFR-051: ë¬¸ì„œí™”
- **API ë¬¸ì„œ**: OpenAPI 3.0 + Postman Collection
- **ì•„í‚¤í…ì²˜**: Mermaid, PlantUML ë‹¤ì´ì–´ê·¸ë¨
- **ìš´ì˜ ë§¤ë‰´ì–¼**: Runbook, Troubleshooting Guide

#### NFR-052: ëª¨ë‹ˆí„°ë§
- **ë©”íŠ¸ë¦­**: Prometheus + Grafana
- **ë¡œê¹…**: Azure Log Analytics
- **ì¶”ì **: Jaeger (Distributed Tracing)

---

## 5. ì œì•½ì‚¬í•­ (Constraints)

### 5.1 ê¸°ìˆ  ì œì•½ì‚¬í•­

- **ì–¸ì–´**: Rust (Agent, API Server), Go (Flipt), TypeScript (Dashboard)
- **í´ë¼ìš°ë“œ**: Azureë§Œ ì‚¬ìš© (AWS, GCP ë¶ˆê°€)
- **ë°ì´í„° ì €ì¥**: í•œêµ­ ë¦¬ì „ì—ë§Œ ì €ì¥ (GDPR, ê°œì¸ì •ë³´ë³´í˜¸ë²•)

### 5.2 ê·œì œ ì œì•½ì‚¬í•­

- **ISO 26262**: ASIL-D ë“±ê¸‰ ì¤€ìˆ˜
- **GDPR**: EU ì°¨ëŸ‰ ë°ì´í„° ì²˜ë¦¬ ì‹œ ì¤€ìˆ˜
- **ê°œì¸ì •ë³´ë³´í˜¸ë²•**: í•œêµ­ ì°¨ëŸ‰ ë°ì´í„° ì•”í˜¸í™”

### 5.3 ë¹„ì¦ˆë‹ˆìŠ¤ ì œì•½ì‚¬í•­

- **ì˜ˆì‚°**: 23ì–µ ì› (ë¶€ê°€ì„¸ ì œì™¸)
- **ì¼ì •**: 30ê°œì›” (2026.03 ~ 2028.08)
- **ì¸ë ¥**: Phase 1 5ëª…, Phase 2 10ëª…, Phase 3 15ëª…

---

## 6. ìˆ˜ìš© ê¸°ì¤€ (Acceptance Criteria)

### 6.1 Phase 1: MVP (12ê°œì›”)

- [ ] Rust API Server ë°°í¬ (3 pods, 99% uptime)
- [ ] Rust Vehicle Agent ë™ì‘ (10ëŒ€ ì°¨ëŸ‰)
- [ ] Admin Dashboard ê¸°ë³¸ ê¸°ëŠ¥ (Flag CRUD, Kill Switch)
- [ ] C++ SDK ë°°í¬ (AUTOSAR Adaptive)
- [ ] API ì‘ë‹µ ì‹œê°„ P95 < 100ms (MVP ê¸°ì¤€ ì™„í™”)

### 6.2 Phase 2: Production (12ê°œì›”)

- [ ] Flipt ì—”ì§„ ì»¤ìŠ¤í„°ë§ˆì´ì§• ì™„ë£Œ
- [ ] A/B ì‹¤í—˜ ê¸°ëŠ¥ (ClickHouse ì—°ë™)
- [ ] Python/Rust SDK ë°°í¬
- [ ] 100ëŒ€ ì°¨ëŸ‰ ì§€ì›
- [ ] API ì‘ë‹µ ì‹œê°„ P95 < 50ms

### 6.3 Phase 3: Scale-Up (6ê°œì›”)

- [ ] 10,000ëŒ€ ì°¨ëŸ‰ ì§€ì›
- [ ] API Gateway í†µí•© (Kong/Istio)
- [ ] ISO 26262 ì¸ì¦ ì™„ë£Œ
- [ ] ì‹œìŠ¤í…œ ê°€ìš©ì„± 99.9%
- [ ] Kill Switch ì „íŒŒ < 3ì´ˆ

---

## 7. ì¶”ì ì„± ë§¤íŠ¸ë¦­ìŠ¤ (Traceability Matrix)

| ìš”êµ¬ì‚¬í•­ ID | ì•„í‚¤í…ì²˜ ì»´í¬ë„ŒíŠ¸ | í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ |
|------------|------------------|--------------|
| FR-001 | API Server, PostgreSQL | TC-001 |
| FR-002 | Flipt Engine, Agent | TC-002 |
| FR-011 | WebSocket, Redis Pub/Sub | TC-011 |
| FR-020 | C++ SDK, Agent | TC-020 |
| FR-030 | Rust Agent, SQLite | TC-030 |
| NFR-001 | API Server, Axum | TC-NFR-001 |
| NFR-003 | WebSocket, Agent | TC-NFR-003 |

---

## 8. ë¶€ë¡ (Appendix)

### 8.1 ìš©ì–´ ì •ì˜ (Glossary)

- **Feature Flag**: ì½”ë“œ ë°°í¬ ì—†ì´ ê¸°ëŠ¥ í™œì„±í™”/ë¹„í™œì„±í™”ë¥¼ ì œì–´í•˜ëŠ” í† ê¸€
- **Kill Switch**: ê¸´ê¸‰ ìƒí™© ì‹œ ê¸°ëŠ¥ì„ ì¦‰ì‹œ ë¹„í™œì„±í™”í•˜ëŠ” ë©”ì»¤ë‹ˆì¦˜
- **Sticky Assignment**: ë™ì¼ ì°¨ëŸ‰(VIN)ì´ í•­ìƒ ë™ì¼ Variantë¥¼ í• ë‹¹ë°›ëŠ” ë°©ì‹
- **Shadow Mode**: ì‹ ê·œ ì•Œê³ ë¦¬ì¦˜ì„ ë°±ê·¸ë¼ìš´ë“œì—ì„œ ì‹¤í–‰í•˜ê³  ë©”íŠ¸ë¦­ë§Œ ìˆ˜ì§‘
- **ASIL-D**: ISO 26262 ìµœê³  ì•ˆì „ ë“±ê¸‰ (Automotive Safety Integrity Level D)
- **mTLS**: Mutual TLS, ì–‘ë°©í–¥ ì¸ì¦ì„œ ê¸°ë°˜ ì•”í˜¸í™”

### 8.2 ì•½ì–´ (Abbreviations)

- **SDV**: Software Defined Vehicle
- **VIN**: Vehicle Identification Number
- **PoC**: Proof of Concept
- **HPA**: Horizontal Pod Autoscaler (Kubernetes)
- **TTL**: Time To Live
- **P95/P99**: 95th/99th Percentile

---

**ìŠ¹ì¸**:
- [ ] í”„ë¡œì íŠ¸ ë§¤ë‹ˆì €: ______________ (ë‚ ì§œ: ______)
- [ ] ì•„í‚¤í…íŠ¸: ______________ (ë‚ ì§œ: ______)
- [ ] Safety ë‹´ë‹¹ì: ______________ (ë‚ ì§œ: ______)

**ë³€ê²½ ì´ë ¥**:
| ë²„ì „ | ë‚ ì§œ | ì‘ì„±ì | ë³€ê²½ ë‚´ìš© |
|------|------|--------|-----------|
| v1.0 | 2026-02-01 | FleetFlag Team | ì´ˆì•ˆ ì‘ì„± |

---

**ë¬¸ì„œ ë**
